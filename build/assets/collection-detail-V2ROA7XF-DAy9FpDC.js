import{J as I}from"./chunk-3IW4HYUP-DTbTbYs9.js";import{u as N}from"./chunk-QBDU475K--UbpR47S.js";import{h as z,w as L,j as e,N as Q,O as H,q as j,u as p,C as w,H as C,A as g,T as f,k as O,r as _,s as K,t as m}from"./index-DQ7iaOIo.js";import{u as M,a as W}from"./chunk-55F244YM-B_ivUNU-.js";import{u as Y,D as $}from"./chunk-MOFW5DA3-BBRzwwAr.js";import"./lodash-BbEdBw2P.js";import"./chunk-7LAPOKHJ-CJKFdgcT.js";import"./chunk-M566SHKI-CpCecA-q.js";import{u as F}from"./chunk-4N7PLYUW-DRfoew5M.js";import{c as G,a as J,d as P,e as B}from"./chunk-ZBNCTGKS-C_X4IB2p.js";import{P as b}from"./pencil-square-C2dQ88SM.js";import{T as S}from"./trash-AHlgA58B.js";import{P as U}from"./plus-CQspOzlS.js";import{u as x}from"./use-prompt-DSUtE_64.js";import{C as v}from"./checkbox-BXdKf1Kl.js";import{c as V}from"./index-DW7vLJga.js";import"./arrow-up-right-on-box-CErxVq_8.js";import"./Trans-LG4CmYWt.js";import"./x-mark-mini-DjxzaqmQ.js";import"./triangle-down-mini-CMQwg4p-.js";import"./square-two-stack-0Hf-pV3m.js";import"./chunk-6XHB4MRO-D_LOUyOE.js";import"./chunk-PHMALPVO-BXYfPvrg.js";import"./chunk-ADOCJB6L-DwJI6LYz.js";import"./chunk-P3UUX2T6-OlAXa1VC.js";import"./chunk-C76H5USB-BzcnRuay.js";import"./chunk-NGTKJO6Q-CBxZNPj4.js";import"./chunk-OPYB3EPU-Gu9ostxc.js";import"./chunk-AYIUW4A5-32QjTsWY.js";import"./chunk-5FUV23JF-BunLQmqw.js";import"./chunk-RKBIB2RM-cgj6pqOB.js";import"./label-DsyTUQgE.js";import"./chunk-WX2SMNCD-CYp4yo3d.js";import"./plus-mini-DfhjBeEB.js";import"./command-bar-B4tNt0in.js";import"./index-T2cn0UOM.js";import"./chunk-QAF7PVQE-D70u5tsT.js";import"./format-CJ2FegFx.js";import"./_baseIsEqual-DdDy9tKi.js";import"./date-picker-BsdoIRhX.js";import"./clsx-B-dksMZM.js";import"./popover-C1ro1ubo.js";import"./triangle-left-mini-o3U9ykef.js";import"./chunk-DMYZ6SLX-CvGU_oYL.js";import"./prompt-BKfKBHyN.js";import"./index-CIxKSFC7.js";const Z={widgets:[]},X={widgets:[]};var ee=({collection:s})=>{const{t}=p(),o=x(),{mutateAsync:r}=J(s.id),a=async()=>{await o({title:t("general.areYouSure"),description:t("collections.deleteWarning",{count:1})})&&await r()};return e.jsxs(w,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(C,{children:s.title}),e.jsx(g,{groups:[{actions:[{icon:e.jsx(b,{}),label:t("actions.edit"),to:`/collections/${s.id}/edit`,disabled:!s.id}]},{actions:[{icon:e.jsx(S,{}),label:t("actions.delete"),onClick:a,disabled:!s.id}]}]})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[e.jsx(f,{size:"small",leading:"compact",weight:"plus",children:t("fields.handle")}),e.jsxs(f,{size:"small",children:["/",s.handle]})]})]})},d=10,te=({collection:s})=>{const{t}=p(),{searchParams:o,raw:r}=M({pageSize:d}),{products:a,count:i,isLoading:c,isError:n,error:T}=F({limit:d,...o,collection_id:[s.id]},{placeholderData:O}),k=W(["collections"]),h=se(),{table:D}=Y({data:a??[],columns:h,getRowId:l=>l.id,count:i,enablePagination:!0,enableRowSelection:!0,pageSize:d,meta:{collectionId:s.id}}),A=x(),{mutateAsync:R}=P(s.id),q=async l=>{const u=Object.keys(l);await A({title:t("general.areYouSure"),description:t("collections.removeProductsWarning",{count:u.length}),confirmText:t("actions.remove"),cancelText:t("actions.cancel")})&&await R({remove:u},{onSuccess:()=>{m.success(t("collections.products.remove.successToast",{count:u.length}))},onError:E=>{m.error(E.message)}})};if(n)throw T;return e.jsxs(w,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(C,{level:"h2",children:t("products.domain")}),e.jsx(g,{groups:[{actions:[{icon:e.jsx(U,{}),label:t("actions.add"),to:"products"}]}]})]}),e.jsx($,{table:D,columns:h,search:!0,pagination:!0,pageSize:d,navigateTo:({original:l})=>`/products/${l.id}`,count:i,filters:k,isLoading:c,orderBy:["title","created_at","updated_at"],queryObject:r,commands:[{action:q,label:t("actions.remove"),shortcut:"r"}],noRecords:{message:t("collections.products.list.noRecordsMessage")}})]})},oe=({product:s,collectionId:t})=>{const{t:o}=p(),r=x(),{mutateAsync:a}=P(t),i=async()=>{await r({title:o("general.areYouSure"),description:o("collections.removeSingleProductWarning",{title:s.title}),confirmText:o("actions.remove"),cancelText:o("actions.cancel")})&&await a({remove:[s.id]},{onSuccess:()=>{m.success(o("collections.products.remove.successToast",{count:1}))},onError:n=>{m.error(n.message)}})};return e.jsx(g,{groups:[{actions:[{icon:e.jsx(b,{}),label:o("actions.edit"),to:`/products/${s.id}/edit`}]},{actions:[{icon:e.jsx(S,{}),label:o("actions.remove"),onClick:i}]}]})},y=V(),se=()=>{const s=N();return _.useMemo(()=>[y.display({id:"select",header:({table:t})=>e.jsx(v,{checked:t.getIsSomePageRowsSelected()?"indeterminate":t.getIsAllPageRowsSelected(),onCheckedChange:o=>t.toggleAllPageRowsSelected(!!o)}),cell:({row:t})=>e.jsx(v,{checked:t.getIsSelected(),onCheckedChange:o=>t.toggleSelected(!!o),onClick:o=>{o.stopPropagation()}})}),...s,y.display({id:"actions",cell:({row:t,table:o})=>{const{collectionId:r}=o.options.meta;return e.jsx(oe,{product:t.original,collectionId:r})}})],[s])},Ze=()=>{const s=z(),{id:t}=L(),{collection:o,isLoading:r,isError:a,error:i}=G(t,{initialData:s});if(r)return e.jsx("div",{children:"Loading..."});if(a||!o)throw i||Q("An unknown error occurred",500);return e.jsxs("div",{className:"flex flex-col gap-y-3",children:[X.widgets.map((c,n)=>e.jsx("div",{children:e.jsx(c.Component,{data:o})},n)),e.jsx(ee,{collection:o}),e.jsx(te,{collection:o}),Z.widgets.map((c,n)=>e.jsx("div",{children:e.jsx(c.Component,{data:o})},n)),e.jsx(I,{data:o}),e.jsx(H,{})]})},re=s=>({queryKey:B.detail(s),queryFn:async()=>K.admin.productCollection.retrieve(s)}),Xe=async({params:s})=>{const t=s.id,o=re(t);return j.getQueryData(o.queryKey)??await j.fetchQuery(o)};export{Ze as Component,Xe as loader};
