import{L as B}from"./chunk-6WKBBTKM-BQVKseFE.js";import{u as M}from"./chunk-GFQLC5NX-CVzMW7Ex.js";import{a as O,b as Q,g as F,c as H}from"./chunk-54IEHX46-DWMq7yL7.js";import{J as N}from"./chunk-3IW4HYUP-DTbTbYs9.js";import{u as $}from"./chunk-QBDU475K--UbpR47S.js";import{w as J,h as K,j as e,O as G,q as P,u as h,C as v,H as y,A as w,T as c,r as u,$ as T,y as V,J as j,B as U,L as Y,k as Z,v as W,t as S}from"./index-DQ7iaOIo.js";import{u as X,a as ee}from"./chunk-55F244YM-B_ivUNU-.js";import{u as se,D as te}from"./chunk-MOFW5DA3-BBRzwwAr.js";import"./lodash-BbEdBw2P.js";import"./chunk-7LAPOKHJ-CJKFdgcT.js";import"./chunk-M566SHKI-CpCecA-q.js";import{u as re}from"./chunk-4N7PLYUW-DRfoew5M.js";import{b,d as ae,c as ie}from"./chunk-2FB644HY-BHty38NP.js";import{P as D}from"./pencil-square-C2dQ88SM.js";import{T as oe}from"./trash-AHlgA58B.js";import{F as z}from"./folder-illustration-8yBiBsTN.js";import{P as le}from"./plus-mini-DfhjBeEB.js";import{u as ce}from"./use-prompt-DSUtE_64.js";import{S as k}from"./status-badge-CrS-Pq0N.js";import{C as g}from"./command-bar-B4tNt0in.js";import{C as _}from"./checkbox-BXdKf1Kl.js";import{c as ne}from"./index-DW7vLJga.js";import"./arrow-up-right-on-box-CErxVq_8.js";import"./Trans-LG4CmYWt.js";import"./x-mark-mini-DjxzaqmQ.js";import"./triangle-down-mini-CMQwg4p-.js";import"./square-two-stack-0Hf-pV3m.js";import"./chunk-6XHB4MRO-D_LOUyOE.js";import"./chunk-PHMALPVO-BXYfPvrg.js";import"./chunk-ADOCJB6L-DwJI6LYz.js";import"./chunk-P3UUX2T6-OlAXa1VC.js";import"./chunk-C76H5USB-BzcnRuay.js";import"./chunk-NGTKJO6Q-CBxZNPj4.js";import"./chunk-OPYB3EPU-Gu9ostxc.js";import"./chunk-AYIUW4A5-32QjTsWY.js";import"./chunk-5FUV23JF-BunLQmqw.js";import"./chunk-RKBIB2RM-cgj6pqOB.js";import"./label-DsyTUQgE.js";import"./chunk-WX2SMNCD-CYp4yo3d.js";import"./chunk-QAF7PVQE-D70u5tsT.js";import"./format-CJ2FegFx.js";import"./_baseIsEqual-DdDy9tKi.js";import"./date-picker-BsdoIRhX.js";import"./clsx-B-dksMZM.js";import"./popover-C1ro1ubo.js";import"./index-T2cn0UOM.js";import"./triangle-left-mini-o3U9ykef.js";import"./chunk-DMYZ6SLX-CvGU_oYL.js";import"./prompt-BKfKBHyN.js";import"./index-CIxKSFC7.js";const de={widgets:[]},me={widgets:[]},pe={widgets:[]},xe={widgets:[]};var ge=({category:r})=>{const{t:s}=h(),t=O(r.is_active,s),i=Q(r.is_internal,s),l=M(r);return e.jsxs(v,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(y,{children:r.name}),e.jsxs("div",{className:"flex items-center gap-x-4",children:[e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx(k,{color:t.color,children:t.label}),e.jsx(k,{color:i.color,children:i.label})]}),e.jsx(w,{groups:[{actions:[{label:s("actions.edit"),icon:e.jsx(D,{}),to:"edit"}]},{actions:[{label:s("actions.delete"),icon:e.jsx(oe,{}),onClick:l}]}]})]})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 gap-3 px-6 py-4",children:[e.jsx(c,{size:"small",leading:"compact",weight:"plus",children:s("fields.description")}),e.jsx(c,{size:"small",leading:"compact",children:r.description||"-"})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 gap-3 px-6 py-4",children:[e.jsx(c,{size:"small",leading:"compact",weight:"plus",children:s("fields.handle")}),e.jsxs(c,{size:"small",leading:"compact",children:["/",r.handle]})]})]})},ue=({category:r})=>{const{t:s}=h();return e.jsxs(v,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(y,{level:"h2",children:s("categories.organize.header")}),e.jsx(w,{groups:[{actions:[{label:s("categories.organize.action"),icon:e.jsx(D,{}),to:"organize"}]}]})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start gap-3 px-6 py-4",children:[e.jsx(c,{size:"small",leading:"compact",weight:"plus",children:s("categories.fields.path.label")}),e.jsx(he,{category:r})]}),e.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-start gap-3 px-6 py-4",children:[e.jsx(c,{size:"small",leading:"compact",weight:"plus",children:s("categories.fields.children.label")}),e.jsx(je,{category:r})]})]})},he=({category:r})=>{const[s,t]=u.useState(!1),{t:i}=h(),{product_category:l,isLoading:m,isError:a,error:n}=b(r.id,{include_ancestors_tree:!0,fields:"id,name,*parent_category"}),o=u.useMemo(()=>F(l),[l]);if(m||!l)return e.jsx(T,{className:"h-5 w-16"});if(a)throw n;return o.length?o.length>1&&!s?e.jsxs("div",{className:"grid grid-cols-[20px_1fr] items-start gap-x-2",children:[e.jsx(z,{}),e.jsxs("div",{className:"flex items-center gap-x-0.5",children:[e.jsx(V,{content:i("categories.fields.path.tooltip"),children:e.jsx("button",{className:"outline-none",type:"button",onClick:()=>t(!0),children:e.jsx(c,{size:"xsmall",leading:"compact",weight:"plus",children:"..."})})}),e.jsx(j,{}),e.jsx(c,{size:"xsmall",leading:"compact",weight:"plus",className:"truncate",children:o[o.length-1].name})]})]}):o.length>1&&s?e.jsxs("div",{className:"grid grid-cols-[20px_1fr] items-start gap-x-2",children:[e.jsx(z,{}),e.jsx("div",{className:"gap- flex flex-wrap items-center gap-x-0.5 gap-y-1",children:o.map((d,x)=>e.jsxs("div",{className:"flex items-center gap-x-0.5",children:[x===o.length-1?e.jsx(c,{size:"xsmall",leading:"compact",weight:"plus",children:d.name}):e.jsx(B,{to:`/categories/${d.id}`,className:"txt-compact-xsmall-plus text-ui-fg-subtle hover:text-ui-fg-base focus-visible:text-ui-fg-base",children:d.name}),x<o.length-1&&e.jsx(j,{})]},d.id))})]}):e.jsx("div",{className:"grid grid-cols-1 items-start gap-x-2",children:o.map((d,x)=>e.jsxs("div",{className:"flex items-center gap-x-0.5",children:[e.jsx(c,{size:"xsmall",leading:"compact",weight:"plus",children:d.name}),x<o.length-1&&e.jsx(j,{})]},d.id))}):e.jsx(c,{size:"small",leading:"compact",children:"-"})},je=({category:r})=>{const{product_category:s,isLoading:t,isError:i,error:l}=b(r.id,{include_descendants_tree:!0,fields:"id,name,category_children"}),m=u.useMemo(()=>H(s),[s]);if(t||!s)return e.jsx(T,{className:"h-5 w-16"});if(i)throw l;return m.length?e.jsx("div",{className:"flex flex-wrap gap-1",children:m.map(a=>e.jsx(U,{size:"2xsmall",asChild:!0,children:e.jsx(Y,{to:`/categories/${a.id}`,children:a.name})},a.id))}):e.jsx(c,{size:"small",leading:"compact",children:"-"})},f=10,fe=({category:r})=>{const{t:s}=h(),t=ce(),[i,l]=u.useState({}),{raw:m,searchParams:a}=X({pageSize:f}),{products:n,count:o,isLoading:d,isError:x,error:L}=re({...a,category_id:[r.id]},{placeholderData:Z}),C=ye(),E=ee(["categories"]),{table:R}=se({data:n||[],columns:C,count:o,getRowId:p=>p.id,pageSize:f,enableRowSelection:!0,enablePagination:!0,rowSelection:{state:i,updater:l}}),{mutateAsync:A}=ae(r.id),I=async()=>{const p=Object.keys(i);await t({title:s("general.areYouSure"),description:s("categories.products.remove.confirmation",{count:p.length}),confirmText:s("actions.remove"),cancelText:s("actions.cancel")})&&await A({remove:p},{onSuccess:()=>{S.success(s("categories.products.remove.successToast",{count:p.length})),l({})},onError:q=>{S.error(q.message)}})};if(x)throw L;return e.jsxs(v,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(y,{level:"h2",children:s("products.domain")}),e.jsx(w,{groups:[{actions:[{label:s("actions.add"),icon:e.jsx(le,{}),to:"products"}]}]})]}),e.jsx(te,{table:R,filters:E,columns:C,orderBy:["title","created_at","updated_at"],pageSize:f,count:o,navigateTo:p=>`/products/${p.id}`,isLoading:d,queryObject:m,noRecords:{message:s("categories.products.list.noRecordsMessage")}}),e.jsx(g,{open:!!Object.keys(i).length,children:e.jsxs(g.Bar,{children:[e.jsx(g.Value,{children:s("general.countSelected",{count:Object.keys(i).length})}),e.jsx(g.Seperator,{}),e.jsx(g.Command,{action:I,label:s("actions.remove"),shortcut:"r"})]})})]})},ve=ne(),ye=()=>{const r=$();return u.useMemo(()=>[ve.display({id:"select",header:({table:s})=>e.jsx(_,{checked:s.getIsSomePageRowsSelected()?"indeterminate":s.getIsAllPageRowsSelected(),onCheckedChange:t=>s.toggleAllPageRowsSelected(!!t)}),cell:({row:s})=>e.jsx(_,{checked:s.getIsSelected(),onCheckedChange:t=>s.toggleSelected(!!t),onClick:t=>{t.stopPropagation()}})}),...r],[r])},vs=()=>{const{id:r}=J(),s=K(),{product_category:t,isLoading:i,isError:l,error:m}=b(r,void 0,{initialData:s});if(i||!t)return e.jsx("div",{children:"Loading..."});if(l)throw m;return e.jsxs("div",{className:"flex flex-col gap-y-3",children:[me.widgets.map((a,n)=>e.jsx("div",{children:e.jsx(a.Component,{data:t})},n)),e.jsxs("div",{className:"flex flex-col gap-x-4 gap-y-3 xl:flex-row xl:items-start",children:[e.jsxs("div",{className:"flex w-full flex-col gap-y-3",children:[e.jsx(ge,{category:t}),e.jsx(fe,{category:t}),de.widgets.map((a,n)=>e.jsx("div",{children:e.jsx(a.Component,{data:t})},n)),e.jsx("div",{className:"hidden xl:block",children:e.jsx(N,{data:t})})]}),e.jsxs("div",{className:"flex w-full max-w-[100%] flex-col gap-y-3 xl:max-w-[400px]",children:[xe.widgets.map((a,n)=>e.jsx("div",{children:e.jsx(a.Component,{data:t})},n)),e.jsx(ue,{category:t}),pe.widgets.map((a,n)=>e.jsx("div",{children:e.jsx(a.Component,{data:t})},n)),e.jsx("div",{className:"xl:hidden",children:e.jsx(N,{data:t})})]})]}),e.jsx(G,{})]})},we=r=>({queryKey:ie.detail(r),queryFn:async()=>W.categories.retrieve(r)}),ys=async({params:r})=>{const s=r.id,t=we(s);return P.getQueryData(t.queryKey)??await P.fetchQuery(t)};export{vs as Component,ys as loader};
