import{u as I}from"./chunk-QBDU475K--UbpR47S.js";import{w as z,j as e,u as y,r as P,k as D,t as x,y as F}from"./index-DQ7iaOIo.js";import{u as H,a as B}from"./chunk-55F244YM-B_ivUNU-.js";import{u as M,D as L}from"./chunk-MOFW5DA3-BBRzwwAr.js";import"./lodash-BbEdBw2P.js";import"./chunk-7LAPOKHJ-CJKFdgcT.js";import"./chunk-M566SHKI-CpCecA-q.js";import{u as N,f as O}from"./chunk-AYIUW4A5-32QjTsWY.js";import{u as V}from"./chunk-4N7PLYUW-DRfoew5M.js";import{R as m,u as q}from"./chunk-RLLZZQKN-CuYY48Je.js";import{u as G,H as Q}from"./chunk-C7RYT3S3-DvWl1ixb.js";import{t as Z}from"./zod-DqtdDTUb.js";import{o as $,a as J,s as K}from"./index-yuYasa5Y.js";import{B as C}from"./label-DsyTUQgE.js";import{C as j}from"./checkbox-BXdKf1Kl.js";import{c as U}from"./index-DW7vLJga.js";import"./chunk-6XHB4MRO-D_LOUyOE.js";import"./chunk-PHMALPVO-BXYfPvrg.js";import"./chunk-ADOCJB6L-DwJI6LYz.js";import"./chunk-P3UUX2T6-OlAXa1VC.js";import"./chunk-C76H5USB-BzcnRuay.js";import"./chunk-NGTKJO6Q-CBxZNPj4.js";import"./chunk-OPYB3EPU-Gu9ostxc.js";import"./chunk-5FUV23JF-BunLQmqw.js";import"./chunk-RKBIB2RM-cgj6pqOB.js";import"./chunk-WX2SMNCD-CYp4yo3d.js";import"./plus-mini-DfhjBeEB.js";import"./command-bar-B4tNt0in.js";import"./index-T2cn0UOM.js";import"./chunk-QAF7PVQE-D70u5tsT.js";import"./format-CJ2FegFx.js";import"./_baseIsEqual-DdDy9tKi.js";import"./date-picker-BsdoIRhX.js";import"./clsx-B-dksMZM.js";import"./popover-C1ro1ubo.js";import"./x-mark-mini-DjxzaqmQ.js";import"./triangle-left-mini-o3U9ykef.js";import"./chunk-DMYZ6SLX-CvGU_oYL.js";import"./prompt-BKfKBHyN.js";import"./index-CIxKSFC7.js";var W=$({product_ids:J(K()).min(1)}),f=50,X=({salesChannel:a})=>{const{t:o}=y(),{handleSuccess:s}=q(),t=G({defaultValues:{product_ids:[]},resolver:Z(W)}),{setValue:l}=t,{mutateAsync:c,isPending:p}=O(a.id),[d,u]=P.useState({}),i=r=>{const n=typeof r=="function"?r(d):r,h=Object.keys(n);l("product_ids",h,{shouldDirty:!0,shouldTouch:!0}),u(n)},{searchParams:b,raw:_}=H({pageSize:f}),{products:v,count:g,isPending:w,isError:T,error:R}=V({fields:"*variants,*sales_channels",...b},{placeholderData:D}),S=ee(),A=B(["sales_channel_id"]),{table:k}=M({data:v??[],columns:S,enableRowSelection:r=>{var n;return!((n=r.original.sales_channels)!=null&&n.map(h=>h.id).includes(a.id))},enablePagination:!0,getRowId:r=>r.id,pageSize:f,count:g,rowSelection:{state:d,updater:i},meta:{salesChannelId:a.id}}),E=t.handleSubmit(async r=>{await c({product_ids:r.product_ids},{onSuccess:()=>{x.success(o("salesChannels.toast.update")),s()},onError:n=>x.error(n.message)})});if(T)throw R;return e.jsx(m.Form,{form:t,children:e.jsxs("form",{onSubmit:E,className:"flex h-full flex-col overflow-hidden",children:[e.jsx(m.Header,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[t.formState.errors.product_ids&&e.jsx(Q,{variant:"error",children:t.formState.errors.product_ids.message}),e.jsx(m.Close,{asChild:!0,children:e.jsx(C,{size:"small",variant:"secondary",children:o("actions.cancel")})}),e.jsx(C,{size:"small",type:"submit",isLoading:p,children:o("actions.save")})]})}),e.jsx(m.Body,{className:"flex size-full flex-col overflow-y-auto",children:e.jsx(L,{table:k,count:g,columns:S,pageSize:f,isLoading:w,filters:A,orderBy:["title","status","created_at","updated_at"],queryObject:_,layout:"fill",pagination:!0,search:!0,noRecords:{message:o("salesChannels.products.add.list.noRecordsMessage")}})})]})})},Y=U(),ee=()=>{const a=I(),{t:o}=y();return P.useMemo(()=>[Y.display({id:"select",header:({table:s})=>e.jsx(j,{checked:s.getIsSomePageRowsSelected()?"indeterminate":s.getIsAllPageRowsSelected(),onCheckedChange:t=>s.toggleAllPageRowsSelected(!!t)}),cell:({row:s,table:t})=>{var u;const{salesChannelId:l}=t.options.meta,c=(u=s.original.sales_channels)==null?void 0:u.map(i=>i.id).includes(l),p=s.getIsSelected()||c,d=e.jsx(j,{checked:p,disabled:c,onCheckedChange:i=>s.toggleSelected(!!i),onClick:i=>{i.stopPropagation()}});return c?e.jsx(F,{content:o("salesChannels.productAlreadyAdded"),side:"right",children:d}):d}}),...a],[o,a])},Oe=()=>{const{id:a}=z(),{sales_channel:o,isPending:s,isError:t,error:l}=N(a);if(t)throw l;return e.jsx(m,{children:!s&&o&&e.jsx(X,{salesChannel:o})})};export{Oe as Component};
