import{G as h}from"./chunk-WB4H3U4D-CY8Oxnvl.js";import{w as S,N as y,j as e,u as w,r as C,bW as Z,t as j,H as b}from"./index-DQ7iaOIo.js";import"./chunk-ESMNJXW4-D5qWVhzW.js";import{S as g}from"./chunk-6WYMDHSN-0x6WvE4o.js";import"./chunk-MOFW5DA3-BBRzwwAr.js";import"./lodash-BbEdBw2P.js";import"./chunk-7LAPOKHJ-CJKFdgcT.js";import"./chunk-M566SHKI-CpCecA-q.js";import{c as z}from"./chunk-4HI66HSD-Qtu4Hyf5.js";import{u as A}from"./chunk-3UMDCRM2-NSGJIubw.js";import{R as l,u as E}from"./chunk-RLLZZQKN-CuYY48Je.js";import{u as F}from"./chunk-C7RYT3S3-DvWl1ixb.js";import{t as N}from"./zod-DqtdDTUb.js";import{z as c}from"./index-yuYasa5Y.js";import{B as v}from"./label-DsyTUQgE.js";import"./chunk-NOAFLTPV-B2feSq4-.js";import"./chunk-C76H5USB-BzcnRuay.js";import"./index-DW7vLJga.js";import"./checkbox-BXdKf1Kl.js";import"./index-CIxKSFC7.js";import"./x-mark-mini-DjxzaqmQ.js";import"./chunk-5FUV23JF-BunLQmqw.js";import"./chunk-RKBIB2RM-cgj6pqOB.js";import"./chunk-WX2SMNCD-CYp4yo3d.js";import"./plus-mini-DfhjBeEB.js";import"./command-bar-B4tNt0in.js";import"./index-T2cn0UOM.js";import"./chunk-QAF7PVQE-D70u5tsT.js";import"./format-CJ2FegFx.js";import"./_baseIsEqual-DdDy9tKi.js";import"./date-picker-BsdoIRhX.js";import"./clsx-B-dksMZM.js";import"./popover-C1ro1ubo.js";import"./triangle-left-mini-o3U9ykef.js";import"./chunk-RJJ3HJT5-0qvBrSK4.js";import"./prompt-BKfKBHyN.js";var L=c.object({countries:c.array(c.object({iso_2:c.string().min(2),display_name:c.string()})).min(1)});function O({fulfillmentSetId:i,locationId:d,zone:r}){const{t:o}=w(),{handleSuccess:p}=E(),[u,n]=C.useState(!1),s=F({defaultValues:{countries:r.geo_zones.map(m=>{const t=Z.find(_=>_.iso_2===m.country_code);return{iso_2:m.country_code,display_name:(t==null?void 0:t.display_name)||m.country_code.toUpperCase()}})},resolver:N(L)}),{mutateAsync:f,isPending:x}=z(i,r.id),a=s.handleSubmit(async m=>{await f({geo_zones:m.countries.map(({iso_2:t})=>({country_code:t,type:"country"}))},{onSuccess:()=>{j.success(o("stockLocations.serviceZones.manageAreas.successToast",{name:r.name})),p(`/settings/locations/${d}`)},onError:t=>{j.error(t.message)}})});return e.jsx(l.Form,{form:s,children:e.jsxs("form",{className:"flex h-full flex-col overflow-hidden",onSubmit:a,children:[e.jsx(l.Header,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(l.Close,{asChild:!0,children:e.jsx(v,{variant:"secondary",size:"small",children:o("actions.cancel")})}),e.jsx(v,{type:"submit",size:"small",isLoading:x,children:o("actions.save")})]})}),e.jsx(l.Body,{className:"flex flex-col overflow-hidden",children:e.jsxs(g,{open:u,onOpenChange:n,children:[e.jsx(g.Content,{children:e.jsx("div",{className:"flex flex-col items-center p-16",children:e.jsxs("div",{className:"flex w-full max-w-[720px] flex-col gap-y-8",children:[e.jsx(b,{children:o("stockLocations.serviceZones.manageAreas.header",{name:r.name})}),e.jsx(h,{form:s,onOpenChange:n})]})})}),e.jsx(h.AreaDrawer,{form:s,open:u,onOpenChange:n})]})})]})})}var he=()=>{var f,x;const{location_id:i,fset_id:d,zone_id:r}=S(),{stock_location:o,isPending:p,isError:u,error:n}=A(i,{fields:"*fulfillment_sets.service_zones.geo_zones"}),s=(x=(f=o==null?void 0:o.fulfillment_sets)==null?void 0:f.find(a=>a.id===d))==null?void 0:x.service_zones.find(a=>a.id===r);if(u)throw n;if(!p&&!s)throw y({message:`Service zone with ID ${r} was not found`},404);return e.jsx(l,{prev:`/settings/locations/${i}`,children:!p&&s&&e.jsx(O,{zone:s,fulfillmentSetId:d,locationId:i})})};export{he as Component};
