import{P as S}from"./chunk-SWMQZ55N-BUcYz0eG.js";import{C as V}from"./chunk-RTWIYLDO-edjefSnf.js";import{u as h}from"./chunk-KKUJQ3HN-B-RHKr58.js";import{C as x}from"./chunk-UY4EBCIZ-BkMu1ycI.js";import"./chunk-M566SHKI-CpCecA-q.js";import{w as E,u as C,j as e,H as N,t as f,s as L,v as y}from"./index-DQ7iaOIo.js";import{a as u,u as T}from"./chunk-RLLZZQKN-CuYY48Je.js";import{u as z,F as s}from"./chunk-C7RYT3S3-DvWl1ixb.js";import{f as O,g as q}from"./chunk-4N7PLYUW-DRfoew5M.js";import{t as I}from"./zod-DqtdDTUb.js";import{o as D,s as m,a as _}from"./index-yuYasa5Y.js";import{B as b}from"./label-DsyTUQgE.js";import"./chunk-2FB644HY-BHty38NP.js";import"./x-mark-mini-DjxzaqmQ.js";import"./triangles-mini-BMU6OfpM.js";import"./Trans-LG4CmYWt.js";import"./plus-mini-DfhjBeEB.js";import"./prompt-BKfKBHyN.js";import"./chunk-DMYZ6SLX-CvGU_oYL.js";var M=D({type_id:m().optional(),collection_id:m().optional(),category_ids:_(m()),tag_ids:_(m())}),w=({product:a})=>{var g,j;const{t:r}=C(),{handleSuccess:p}=T(),l=h({queryKey:["product_collections"],queryFn:o=>L.admin.productCollection.list(o),getOptions:o=>o.collections.map(t=>({label:t.title,value:t.id}))}),n=h({queryKey:["product_types"],queryFn:y.productTypes.list,getOptions:o=>o.product_types.map(t=>({label:t.value,value:t.id}))}),c=h({queryKey:["product_tags"],queryFn:y.productTags.list,getOptions:o=>o.product_tags.map(t=>({label:t.value,value:t.id}))}),d=z({defaultValues:{type_id:a.type_id||"",collection_id:a.collection_id||"",category_ids:((g=a.categories)==null?void 0:g.map(o=>o.id))||[],tag_ids:((j=a.tags)==null?void 0:j.map(o=>o.id))||[]},resolver:I(M)}),{mutateAsync:v,isPending:P}=q(a.id),F=d.handleSubmit(async o=>{var t;await v({type_id:o.type_id||void 0,collection_id:o.collection_id||void 0,categories:o.category_ids.map(i=>({id:i}))||void 0,tags:((t=o.tag_ids)==null?void 0:t.map(i=>({id:i})))||void 0},{onSuccess:({product:i})=>{f.success(r("products.organization.edit.toasts.success",{title:i.title})),p()},onError:i=>{f.error(i.message)}})});return e.jsx(u.Form,{form:d,children:e.jsxs("form",{onSubmit:F,className:"flex h-full flex-col",children:[e.jsx(u.Body,{children:e.jsxs("div",{className:"flex h-full flex-col gap-y-4",children:[e.jsx(s.Field,{control:d.control,name:"type_id",render:({field:o})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{optional:!0,children:r("products.fields.type.label")}),e.jsx(s.Control,{children:e.jsx(x,{...o,options:n.options,searchValue:n.searchValue,onSearchValueChange:n.onSearchValueChange,fetchNextPage:n.fetchNextPage})}),e.jsx(s.ErrorMessage,{})]})}),e.jsx(s.Field,{control:d.control,name:"collection_id",render:({field:o})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{optional:!0,children:r("products.fields.collection.label")}),e.jsx(s.Control,{children:e.jsx(x,{...o,options:l.options,searchValue:l.searchValue,onSearchValueChange:l.onSearchValueChange,fetchNextPage:l.fetchNextPage})}),e.jsx(s.ErrorMessage,{})]})}),e.jsx(s.Field,{control:d.control,name:"category_ids",render:({field:o})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{optional:!0,children:r("products.fields.categories.label")}),e.jsx(s.Control,{children:e.jsx(V,{...o})}),e.jsx(s.ErrorMessage,{})]})}),e.jsx(s.Field,{control:d.control,name:"tag_ids",render:({field:o})=>e.jsxs(s.Item,{children:[e.jsx(s.Label,{optional:!0,children:r("products.fields.tags.label")}),e.jsx(s.Control,{children:e.jsx(x,{...o,multiple:!0,options:c.options,searchValue:c.searchValue,onSearchValueChange:c.onSearchValueChange,fetchNextPage:c.fetchNextPage})}),e.jsx(s.ErrorMessage,{})]})})]})}),e.jsx(u.Footer,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(u.Close,{asChild:!0,children:e.jsx(b,{size:"small",variant:"secondary",children:r("actions.cancel")})}),e.jsx(b,{size:"small",type:"submit",isLoading:P,children:r("actions.save")})]})})]})})},re=()=>{const{id:a}=E(),{t:r}=C(),{product:p,isLoading:l,isError:n,error:c}=O(a,{fields:S});if(n)throw c;return e.jsxs(u,{children:[e.jsx(u.Header,{children:e.jsx(N,{children:r("products.organization.edit.header")})}),!l&&p&&e.jsx(w,{product:p})]})};export{re as Component};
