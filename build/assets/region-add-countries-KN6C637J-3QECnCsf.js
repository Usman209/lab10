import{u as T,a as E,b as k}from"./chunk-NOAFLTPV-B2feSq4-.js";import{w as A,j as s,u as I,r as g,bW as z,t as y}from"./index-DQ7iaOIo.js";import{u as F,D as B}from"./chunk-MOFW5DA3-BBRzwwAr.js";import"./lodash-BbEdBw2P.js";import"./chunk-7LAPOKHJ-CJKFdgcT.js";import"./chunk-M566SHKI-CpCecA-q.js";import{R as n,u as D}from"./chunk-RLLZZQKN-CuYY48Je.js";import{u as H}from"./chunk-C7RYT3S3-DvWl1ixb.js";import{c as M,d as N}from"./chunk-QHCOJC4V-B0UJ2So3.js";import{t as L}from"./zod-DqtdDTUb.js";import{o as O,a as V,s as q}from"./index-yuYasa5Y.js";import{B as S}from"./label-DsyTUQgE.js";import{C}from"./checkbox-BXdKf1Kl.js";import{c as G}from"./index-DW7vLJga.js";import"./chunk-C76H5USB-BzcnRuay.js";import"./chunk-5FUV23JF-BunLQmqw.js";import"./chunk-RKBIB2RM-cgj6pqOB.js";import"./chunk-WX2SMNCD-CYp4yo3d.js";import"./plus-mini-DfhjBeEB.js";import"./command-bar-B4tNt0in.js";import"./index-T2cn0UOM.js";import"./chunk-QAF7PVQE-D70u5tsT.js";import"./format-CJ2FegFx.js";import"./_baseIsEqual-DdDy9tKi.js";import"./date-picker-BsdoIRhX.js";import"./clsx-B-dksMZM.js";import"./popover-C1ro1ubo.js";import"./x-mark-mini-DjxzaqmQ.js";import"./triangle-left-mini-o3U9ykef.js";import"./prompt-BKfKBHyN.js";import"./index-CIxKSFC7.js";var Q=O({countries:V(q()).min(1)}),d=50,p="ac",U=({region:r})=>{const{t:e}=I(),{handleSuccess:i}=D(),[t,l]=g.useState({}),m=H({defaultValues:{countries:[]},resolver:L(Q)}),{setValue:f}=m;g.useEffect(()=>{const o=Object.keys(t).filter(a=>t[a]);f("countries",o,{shouldDirty:!0,shouldTouch:!0})},[t,f]);const{searchParams:j,raw:b}=T({pageSize:d,prefix:p}),{countries:_,count:h}=E({countries:z.map((o,a)=>({display_name:o.display_name,name:o.name,id:a,iso_2:o.iso_2,iso_3:o.iso_3,num_code:o.num_code,region_id:null,region:{}})),...j}),x=X(),{table:R}=F({data:_||[],columns:x,count:h,enablePagination:!0,enableRowSelection:o=>{var a;return((a=r.countries)==null?void 0:a.findIndex(c=>c.iso_2===o.original.iso_2))===-1},getRowId:o=>o.iso_2,pageSize:d,rowSelection:{state:t,updater:l},prefix:p}),{mutateAsync:v,isPending:w}=N(r.id),P=m.handleSubmit(async o=>{var c;const a=[...((c=r.countries)==null?void 0:c.map(u=>u.iso_2))??[],...o.countries];await v({countries:a},{onSuccess:()=>{y.success(e("regions.toast.countries")),i()},onError:u=>{y.error(u.message)}})});return s.jsx(n.Form,{form:m,children:s.jsxs("form",{onSubmit:P,className:"flex h-full flex-col overflow-hidden",children:[s.jsx(n.Header,{children:s.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[s.jsx(n.Close,{asChild:!0,children:s.jsx(S,{size:"small",variant:"secondary",children:e("actions.cancel")})}),s.jsx(S,{size:"small",isLoading:w,type:"submit",children:e("actions.add")})]})}),s.jsx(n.Body,{className:"overflow-hidden",children:s.jsx(B,{table:R,columns:x,pageSize:d,count:h,search:!0,pagination:!0,layout:"fill",orderBy:["name","code"],queryObject:b,prefix:p})})]})})},W=G(),X=()=>{const r=k();return g.useMemo(()=>[W.display({id:"select",header:({table:e})=>s.jsx(C,{checked:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),onCheckedChange:i=>e.toggleAllPageRowsSelected(!!i)}),cell:({row:e})=>{const i=!e.getCanSelect();return s.jsx(C,{checked:e.getIsSelected()||i,disabled:i,onCheckedChange:t=>e.toggleSelected(!!t),onClick:t=>{t.stopPropagation()}})}}),...r],[r])},we=()=>{const{id:r}=A(),{region:e,isPending:i,isError:t,error:l}=M(r,{fields:"*payment_providers"});if(t)throw l;return s.jsx(n,{children:!i&&e&&s.jsx(U,{region:e})})};export{we as Component};
