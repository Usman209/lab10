import{g as v}from"./chunk-MWVM4TYO-bKUcYSnf.js";import{u as y,w as E,ch as F,j as e,H as S,ck as I,t as f,I as B}from"./index-DQ7iaOIo.js";import{a,u as w}from"./chunk-RLLZZQKN-CuYY48Je.js";import{u as N,F as l}from"./chunk-C7RYT3S3-DvWl1ixb.js";import{t as T}from"./zod-DqtdDTUb.js";import{o as H,n as L}from"./index-yuYasa5Y.js";import{C as R}from"./currency-input-YdrMuETU.js";import{B as b}from"./label-DsyTUQgE.js";import"./prompt-BKfKBHyN.js";import"./index.esm-C23H4hs_.js";var _=H({limit:L().min(0).optional().nullable()}),z=({campaign:s})=>{var u;const{t:r}=y(),{handleSuccess:m}=w(),i=N({defaultValues:{limit:((u=s==null?void 0:s.budget)==null?void 0:u.limit)||void 0},resolver:T(_)}),{mutateAsync:c,isPending:d}=I(s.id),C=i.handleSubmit(async n=>{await c({budget:{limit:n.limit?n.limit:null}},{onSuccess:({campaign:t})=>{f.success(r("campaigns.edit.successToast",{name:t.name})),m()},onError:t=>{f.error(t.message)}})});return e.jsx(a.Form,{form:i,children:e.jsxs("form",{onSubmit:C,className:"flex flex-1 flex-col",children:[e.jsx(a.Body,{children:e.jsx("div",{className:"flex flex-col gap-y-4",children:e.jsx(l.Field,{control:i.control,name:"limit",render:({field:{onChange:n,value:t,...x}})=>{var p,g,h,j;return e.jsxs(l.Item,{className:"basis-1/2",children:[e.jsx(l.Label,{children:r("campaigns.budget.fields.limit")}),e.jsx(l.Control,{children:((p=s.budget)==null?void 0:p.type)==="spend"?e.jsx(R,{min:0,onValueChange:o=>n(o?parseInt(o):null),code:(g=s.budget)==null?void 0:g.currency_code,symbol:(h=s.budget)!=null&&h.currency_code?v((j=s.budget)==null?void 0:j.currency_code):"",...x,value:t||void 0}):e.jsx(B,{min:0,...x,value:t,onChange:o=>{n(o.target.value===""?null:parseInt(o.target.value))}},"usage")}),e.jsx(l.ErrorMessage,{})]})}})})}),e.jsx(a.Footer,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(a.Close,{asChild:!0,children:e.jsx(b,{variant:"secondary",size:"small",children:r("actions.cancel")})}),e.jsx(b,{isLoading:d,type:"submit",variant:"primary",size:"small",children:r("actions.save")})]})})]})})},J=()=>{const{t:s}=y(),{id:r}=E(),{campaign:m,isLoading:i,isError:c,error:d}=F(r);if(c)throw d;return e.jsxs(a,{children:[e.jsx(a.Header,{children:e.jsx(S,{children:s("campaigns.budget.edit.header")})}),!i&&m&&e.jsx(z,{campaign:m})]})};export{J as Component};
