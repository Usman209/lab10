import{g as _,p as f,a as T,b as A}from"./chunk-G22WWLPG-C9g-VuwI.js";import{a as h}from"./chunk-B4FQDBC3-vSBK5DkU.js";import{a as S}from"./chunk-IQRVIEMV-CAyGAynz.js";import{S as M}from"./chunk-ADOCJB6L-DwJI6LYz.js";import{u as C,D as w}from"./chunk-MOFW5DA3-BBRzwwAr.js";import{a as K,j as e,O as P,u,C as N,H as z,T as b,L as D,r as q,B as v,k as E,A as O,t as m}from"./index-DQ7iaOIo.js";import"./lodash-BbEdBw2P.js";import{u as H}from"./chunk-C76H5USB-BzcnRuay.js";import"./chunk-7LAPOKHJ-CJKFdgcT.js";import"./chunk-M566SHKI-CpCecA-q.js";import{u as L,a as R,b as B}from"./chunk-CC6V6CJZ-Ooc1INLZ.js";import{P as F}from"./pencil-square-C2dQ88SM.js";import{S as J}from"./square-two-stack-0Hf-pV3m.js";import{X as I}from"./x-circle-DtLjBqH9.js";import{T as Q}from"./trash-AHlgA58B.js";import{u as X}from"./use-prompt-DSUtE_64.js";import{B as Y}from"./label-DsyTUQgE.js";import{C as G}from"./copy-BZS7_ZG6.js";import{c as U}from"./index-DW7vLJga.js";import"./chunk-P3UUX2T6-OlAXa1VC.js";import"./format-CJ2FegFx.js";import"./chunk-5FUV23JF-BunLQmqw.js";import"./chunk-RKBIB2RM-cgj6pqOB.js";import"./chunk-WX2SMNCD-CYp4yo3d.js";import"./plus-mini-DfhjBeEB.js";import"./command-bar-B4tNt0in.js";import"./index-T2cn0UOM.js";import"./chunk-QAF7PVQE-D70u5tsT.js";import"./_baseIsEqual-DdDy9tKi.js";import"./date-picker-BsdoIRhX.js";import"./clsx-B-dksMZM.js";import"./popover-C1ro1ubo.js";import"./x-mark-mini-DjxzaqmQ.js";import"./triangle-left-mini-o3U9ykef.js";import"./chunk-AYIUW4A5-32QjTsWY.js";import"./chunk-4N7PLYUW-DRfoew5M.js";import"./chunk-DMYZ6SLX-CvGU_oYL.js";import"./prompt-BKfKBHyN.js";const Z={widgets:[]},$={widgets:[]};var V=({apiKey:t})=>{const{mutateAsync:a}=R(t.id),{mutateAsync:r}=B(t.id),{t:s}=u(),i=X(),n=async()=>{await i({title:s("general.areYouSure"),description:s("apiKeyManagement.delete.warning",{title:t.title}),confirmText:s("actions.delete"),cancelText:s("actions.cancel")})&&await r(void 0,{onSuccess:()=>{m.success(s("apiKeyManagement.delete.successToast",{title:t.title}))},onError:l=>{m.error(l.message)}})},o=async()=>{await i({title:s("general.areYouSure"),description:s("apiKeyManagement.revoke.warning",{title:t.title}),confirmText:s("apiKeyManagement.actions.revoke"),cancelText:s("actions.cancel")})&&await a(void 0,{onSuccess:()=>{m.success(s("apiKeyManagement.revoke.successToast",{title:t.title}))},onError:l=>{m.error(l.message)}})},d=()=>{navigator.clipboard.writeText(t.token),m.success(s("apiKeyManagement.actions.copySuccessToast"))};return e.jsx(O,{groups:[{actions:[{icon:e.jsx(F,{}),label:s("actions.edit"),to:`${t.id}/edit`},...t.type!=="secret"?[{label:s("apiKeyManagement.actions.copy"),onClick:d,icon:e.jsx(J,{})}]:[]]},{actions:[{icon:e.jsx(I,{}),label:s("apiKeyManagement.actions.revoke"),onClick:o},{icon:e.jsx(Q,{}),label:s("actions.delete"),onClick:n}]}]})},c=U(),W=()=>{const{t}=u();return q.useMemo(()=>[c.accessor("title",{header:t("fields.title"),cell:({getValue:a})=>e.jsx("div",{className:"flex size-full items-center",children:e.jsx("span",{className:"truncate",children:a()})})}),c.accessor("redacted",{header:"Token",cell:({getValue:a,row:r})=>{const s=a();if(r.original.type==="secret")return e.jsx(v,{size:"2xsmall",children:f(s)});const n=o=>o.stopPropagation();return e.jsx(v,{size:"2xsmall",className:"max-w-40",onClick:n,children:e.jsx(G,{content:r.original.token,className:"text-ui-fg-subtle",asChild:!0,children:e.jsx(b,{size:"xsmall",leading:"compact",className:"truncate",children:f(s)})})})}}),c.accessor("type",{header:t("fields.type"),cell:({getValue:a})=>{const{label:r}=T(a(),t);return e.jsx(S,{text:r})}}),c.accessor("revoked_at",{header:t("fields.status"),cell:({getValue:a})=>{const{color:r,label:s}=A(a(),t);return e.jsx(M,{color:r,children:s})}}),c.accessor("last_used_at",{header:t("apiKeyManagement.table.lastUsedAtHeader"),cell:({getValue:a})=>{const r=a();return e.jsx(h,{date:r})}}),c.accessor("created_at",{header:t("fields.created"),cell:({getValue:a})=>{const r=a();return e.jsx(h,{date:r})}}),c.display({id:"actions",cell:({row:a})=>e.jsx(V,{apiKey:a.original})})],[t])},ee=()=>{const{t}=u();let a=[];const r=[{label:t("fields.createdAt"),key:"created_at",type:"date"},{label:t("fields.updatedAt"),key:"updated_at",type:"date"},{label:t("fields.revokedAt"),key:"revoked_at",type:"date"}];return a=[...a,...r],a},te=({prefix:t,pageSize:a=20})=>{const r=H(["offset","q","created_at","updated_at","revoked_at","order"],t),{offset:s,created_at:i,updated_at:n,revoked_at:o,q:d,order:p}=r;return{searchParams:{limit:a,offset:s?Number(s):0,created_at:i?JSON.parse(i):void 0,updated_at:n?JSON.parse(n):void 0,revoked_at:o?JSON.parse(o):void 0,order:p,q:d},raw:r}},x=20,ae=({keyType:t})=>{const{t:a}=u(),{searchParams:r,raw:s}=te({pageSize:x}),i={...r,type:t,fields:"id,title,redacted,token,type,created_at,updated_at,revoked_at,last_used_at,created_by,revoked_by"},{api_keys:n,count:o,isLoading:d,isError:p,error:l}=L(i,{placeholderData:E}),j=ee(),g=W(),{table:k}=C({data:n||[],columns:g,count:o,enablePagination:!0,getRowId:y=>y.id,pageSize:x});if(p)throw l;return e.jsxs(N,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsxs("div",{children:[e.jsx(z,{level:"h2",children:a(t==="publishable"?"apiKeyManagement.domain.publishable":"apiKeyManagement.domain.secret")}),e.jsx(b,{className:"text-ui-fg-subtle",size:"small",children:a(t==="publishable"?"apiKeyManagement.subtitle.publishable":"apiKeyManagement.subtitle.secret")})]}),e.jsx(D,{to:"create",children:e.jsx(Y,{variant:"secondary",size:"small",children:a("actions.create")})})]}),e.jsx(w,{table:k,filters:j,columns:g,count:o,pageSize:x,orderBy:["title","created_at","updated_at","revoked_at"],navigateTo:y=>y.id,pagination:!0,search:!0,queryObject:s,isLoading:d})]})},Be=()=>{const{pathname:t}=K(),a=_(t);return e.jsxs("div",{className:"flex flex-col gap-y-2",children:[$.widgets.map((r,s)=>e.jsx("div",{children:e.jsx(r.Component,{})},s)),e.jsx(ae,{keyType:a}),Z.widgets.map((r,s)=>e.jsx("div",{children:e.jsx(r.Component,{})},s)),e.jsx(P,{})]})};export{Be as Component};
