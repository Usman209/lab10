import{u as K,a as k}from"./chunk-NXJOVTDC-CFsvRfiw.js";import{w as M,j as e,u as C,r as x,t as S,y as D,k as E}from"./index-DQ7iaOIo.js";import{u as z,D as B}from"./chunk-MOFW5DA3-BBRzwwAr.js";import"./lodash-BbEdBw2P.js";import"./chunk-7LAPOKHJ-CJKFdgcT.js";import"./chunk-M566SHKI-CpCecA-q.js";import{d as H,h as I}from"./chunk-CC6V6CJZ-Ooc1INLZ.js";import{R as c,u as F}from"./chunk-RLLZZQKN-CuYY48Je.js";import{u as L,H as N}from"./chunk-C7RYT3S3-DvWl1ixb.js";import{a as O}from"./chunk-AYIUW4A5-32QjTsWY.js";import{t as V}from"./zod-DqtdDTUb.js";import{o as q,a as G,s as Q}from"./index-yuYasa5Y.js";import{B as y}from"./label-DsyTUQgE.js";import{C as f}from"./checkbox-BXdKf1Kl.js";import{c as Z}from"./index-DW7vLJga.js";import"./chunk-GA34GXNI-eX0QGNOV.js";import"./chunk-P3UUX2T6-OlAXa1VC.js";import"./chunk-IQRVIEMV-CAyGAynz.js";import"./chunk-ADOCJB6L-DwJI6LYz.js";import"./chunk-C76H5USB-BzcnRuay.js";import"./chunk-5FUV23JF-BunLQmqw.js";import"./chunk-RKBIB2RM-cgj6pqOB.js";import"./chunk-WX2SMNCD-CYp4yo3d.js";import"./plus-mini-DfhjBeEB.js";import"./command-bar-B4tNt0in.js";import"./index-T2cn0UOM.js";import"./chunk-QAF7PVQE-D70u5tsT.js";import"./format-CJ2FegFx.js";import"./_baseIsEqual-DdDy9tKi.js";import"./date-picker-BsdoIRhX.js";import"./clsx-B-dksMZM.js";import"./popover-C1ro1ubo.js";import"./x-mark-mini-DjxzaqmQ.js";import"./triangle-left-mini-o3U9ykef.js";import"./prompt-BKfKBHyN.js";import"./chunk-4N7PLYUW-DRfoew5M.js";import"./chunk-DMYZ6SLX-CvGU_oYL.js";import"./index-CIxKSFC7.js";var $=q({sales_channel_ids:G(Q())}),u=50,J=({apiKey:i,preSelected:t=[]})=>{const{t:s}=C(),{handleSuccess:o}=F(),r=L({defaultValues:{sales_channel_ids:[]},resolver:V($)}),{setValue:l}=r,[n,m]=x.useState({}),{mutateAsync:p,isPending:j}=I(i),{raw:_,searchParams:b}=K({pageSize:u}),h=W(),{sales_channels:T,count:g,isLoading:A}=O({...b},{placeholderData:E}),v=a=>{const d=typeof a=="function"?a(n):a,P=Object.keys(d);l("sales_channel_ids",P,{shouldDirty:!0,shouldTouch:!0}),m(d)},{table:R}=z({data:T??[],columns:h,count:g,enablePagination:!0,enableRowSelection:a=>!t.includes(a.original.id),getRowId:a=>a.id,pageSize:u,rowSelection:{state:n,updater:v}}),w=r.handleSubmit(async a=>{await p({sales_channel_ids:a.sales_channel_ids},{onSuccess:()=>{S.success(s("apiKeyManagement.salesChannels.successToast",{count:a.sales_channel_ids.length})),o()},onError:d=>{S.error(d.message)}})});return e.jsx(c.Form,{form:r,children:e.jsxs("form",{onSubmit:w,className:"flex h-full flex-col overflow-hidden",children:[e.jsx(c.Header,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[r.formState.errors.sales_channel_ids&&e.jsx(N,{variant:"error",children:r.formState.errors.sales_channel_ids.message}),e.jsx(c.Close,{asChild:!0,children:e.jsx(y,{size:"small",variant:"secondary",children:s("actions.cancel")})}),e.jsx(y,{size:"small",type:"submit",isLoading:j,children:s("actions.save")})]})}),e.jsx(c.Body,{children:e.jsx(B,{table:R,columns:h,count:g,pageSize:u,pagination:!0,search:!0,isLoading:A,queryObject:_,orderBy:["name","created_at","updated_at"],layout:"fill",noRecords:{message:s("apiKeyManagement.addSalesChannels.list.noRecordsMessage")}})})]})})},U=Z(),W=()=>{const{t:i}=C(),t=k();return x.useMemo(()=>[U.display({id:"select",header:({table:s})=>e.jsx(f,{checked:s.getIsSomePageRowsSelected()?"indeterminate":s.getIsAllPageRowsSelected(),onCheckedChange:o=>s.toggleAllPageRowsSelected(!!o)}),cell:({row:s})=>{const o=!s.getCanSelect(),r=s.getIsSelected()||o,l=e.jsx(f,{checked:r,disabled:o,onCheckedChange:n=>s.toggleSelected(!!n),onClick:n=>{n.stopPropagation()}});return o?e.jsx(D,{content:i("apiKeyManagement.salesChannels.alreadyAddedTooltip"),side:"right",children:l}):l}}),...t],[i,t])},Be=()=>{var m;const{id:i}=M(),{api_key:t,isLoading:s,isError:o,error:r}=H(i),l=(m=t==null?void 0:t.sales_channels)==null?void 0:m.map(p=>p.id),n=!s&&t;if(o)throw r;return e.jsx(c,{children:n&&e.jsx(J,{apiKey:i,preSelected:l})})};export{Be as Component};
