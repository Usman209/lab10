import{G as j}from"./chunk-WB4H3U4D-CY8Oxnvl.js";import{w as S,N as w,j as e,u as C,r as F,t as g,H as L,I as Z,p as b}from"./index-DQ7iaOIo.js";import"./chunk-ESMNJXW4-D5qWVhzW.js";import{S as v}from"./chunk-6WYMDHSN-0x6WvE4o.js";import"./chunk-MOFW5DA3-BBRzwwAr.js";import"./lodash-BbEdBw2P.js";import"./chunk-7LAPOKHJ-CJKFdgcT.js";import"./chunk-M566SHKI-CpCecA-q.js";import{b as k}from"./chunk-4HI66HSD-Qtu4Hyf5.js";import{u as N}from"./chunk-3UMDCRM2-NSGJIubw.js";import{R as c,u as _}from"./chunk-RLLZZQKN-CuYY48Je.js";import{u as E,F as a}from"./chunk-C7RYT3S3-DvWl1ixb.js";import{t as I}from"./zod-DqtdDTUb.js";import{z as t}from"./index-yuYasa5Y.js";import{B as y}from"./label-DsyTUQgE.js";import"./chunk-NOAFLTPV-B2feSq4-.js";import"./chunk-C76H5USB-BzcnRuay.js";import"./index-DW7vLJga.js";import"./checkbox-BXdKf1Kl.js";import"./index-CIxKSFC7.js";import"./x-mark-mini-DjxzaqmQ.js";import"./chunk-5FUV23JF-BunLQmqw.js";import"./chunk-RKBIB2RM-cgj6pqOB.js";import"./chunk-WX2SMNCD-CYp4yo3d.js";import"./plus-mini-DfhjBeEB.js";import"./command-bar-B4tNt0in.js";import"./index-T2cn0UOM.js";import"./chunk-QAF7PVQE-D70u5tsT.js";import"./format-CJ2FegFx.js";import"./_baseIsEqual-DdDy9tKi.js";import"./date-picker-BsdoIRhX.js";import"./clsx-B-dksMZM.js";import"./popover-C1ro1ubo.js";import"./triangle-left-mini-o3U9ykef.js";import"./chunk-RJJ3HJT5-0qvBrSK4.js";import"./prompt-BKfKBHyN.js";var z=t.object({name:t.string().min(1),countries:t.array(t.object({iso_2:t.string().min(2),display_name:t.string()})).min(1)});function O({fulfillmentSet:m,type:l,location:r}){const{t:s}=C(),{handleSuccess:u}=_(),[p,o]=F.useState(!1),i=E({defaultValues:{name:"",countries:[]},resolver:I(z)}),{mutateAsync:f,isPending:d}=k(m.id),x=i.handleSubmit(async n=>{await f({name:n.name,geo_zones:n.countries.map(({iso_2:h})=>({country_code:h,type:"country"}))},{onSuccess:()=>{g.success(s("stockLocations.serviceZones.create.successToast",{name:n.name})),u(`/settings/locations/${r.id}`)},onError:h=>{g.error(h.message)}})});return e.jsx(c.Form,{form:i,children:e.jsxs("form",{className:"flex h-full flex-col overflow-hidden",onSubmit:x,children:[e.jsx(c.Header,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(c.Close,{asChild:!0,children:e.jsx(y,{variant:"secondary",size:"small",children:s("actions.cancel")})}),e.jsx(y,{type:"submit",size:"small",isLoading:d,children:s("actions.save")})]})}),e.jsx(c.Body,{className:"m-auto flex h-full w-full  flex-col items-center divide-y overflow-hidden",children:e.jsxs(v,{open:p,onOpenChange:o,children:[e.jsx(v.Content,{children:e.jsx("div",{className:"flex flex-1 flex-col items-center overflow-y-auto",children:e.jsxs("div",{className:"flex w-full max-w-[720px] flex-col gap-y-8 px-2 py-16",children:[e.jsx(L,{children:l==="pickup"?s("stockLocations.serviceZones.create.headerPickup",{location:r.name}):s("stockLocations.serviceZones.create.headerShipping",{location:r.name})}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:e.jsx(a.Field,{control:i.control,name:"name",render:({field:n})=>e.jsxs(a.Item,{children:[e.jsx(a.Label,{children:s("fields.name")}),e.jsx(a.Control,{children:e.jsx(Z,{...n})}),e.jsx(a.ErrorMessage,{})]})})}),e.jsx(b,{children:s("stockLocations.serviceZones.fields.tip")}),e.jsx(j,{form:i,onOpenChange:o})]})})}),e.jsx(j.AreaDrawer,{form:i,open:p,onOpenChange:o})]})})]})})}function je(){var d;const{fset_id:m,location_id:l}=S(),{stock_location:r,isLoading:s,isError:u,error:p}=N(l,{fields:"*fulfillment_sets"}),o=(d=r==null?void 0:r.fulfillment_sets)==null?void 0:d.find(x=>x.id===m),i=!s&&!!r&&!!o,f=(o==null?void 0:o.type)==="pickup"?"pickup":"shipping";if(!s&&!o)throw w({message:`Fulfillment set with ID: ${m} was not found.`},404);if(u)throw p;return e.jsx(c,{prev:`/settings/locations/${l}`,children:i&&e.jsx(O,{fulfillmentSet:o,type:f,location:r})})}export{je as Component};
