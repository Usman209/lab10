import{u as z}from"./chunk-QBDU475K--UbpR47S.js";import{w as F,j as e,u as C,r as f,k as H,t as j,y as _}from"./index-DQ7iaOIo.js";import{u as B,a as M}from"./chunk-55F244YM-B_ivUNU-.js";import{u as L,D as N}from"./chunk-MOFW5DA3-BBRzwwAr.js";import"./lodash-BbEdBw2P.js";import"./chunk-7LAPOKHJ-CJKFdgcT.js";import"./chunk-M566SHKI-CpCecA-q.js";import{u as O}from"./chunk-4N7PLYUW-DRfoew5M.js";import{c as V,d as q}from"./chunk-ZBNCTGKS-C_X4IB2p.js";import{R as m,u as G}from"./chunk-RLLZZQKN-CuYY48Je.js";import{u as Q,H as U}from"./chunk-C7RYT3S3-DvWl1ixb.js";import{t as X}from"./zod-DqtdDTUb.js";import{o as Z,a as $,s as J}from"./index-yuYasa5Y.js";import{B as y}from"./label-DsyTUQgE.js";import{C as S}from"./checkbox-BXdKf1Kl.js";import{c as K}from"./index-DW7vLJga.js";import"./chunk-6XHB4MRO-D_LOUyOE.js";import"./chunk-PHMALPVO-BXYfPvrg.js";import"./chunk-ADOCJB6L-DwJI6LYz.js";import"./chunk-P3UUX2T6-OlAXa1VC.js";import"./chunk-C76H5USB-BzcnRuay.js";import"./chunk-NGTKJO6Q-CBxZNPj4.js";import"./chunk-OPYB3EPU-Gu9ostxc.js";import"./chunk-AYIUW4A5-32QjTsWY.js";import"./chunk-5FUV23JF-BunLQmqw.js";import"./chunk-RKBIB2RM-cgj6pqOB.js";import"./chunk-WX2SMNCD-CYp4yo3d.js";import"./plus-mini-DfhjBeEB.js";import"./command-bar-B4tNt0in.js";import"./index-T2cn0UOM.js";import"./chunk-QAF7PVQE-D70u5tsT.js";import"./format-CJ2FegFx.js";import"./_baseIsEqual-DdDy9tKi.js";import"./date-picker-BsdoIRhX.js";import"./clsx-B-dksMZM.js";import"./popover-C1ro1ubo.js";import"./x-mark-mini-DjxzaqmQ.js";import"./triangle-left-mini-o3U9ykef.js";import"./chunk-DMYZ6SLX-CvGU_oYL.js";import"./prompt-BKfKBHyN.js";import"./index-CIxKSFC7.js";var W=Z({add:$(J()).min(1)}),p=50,h="p",Y=({collection:i})=>{const{t:s}=C(),{handleSuccess:t}=G(),o=Q({defaultValues:{add:[]},resolver:X(W)}),{setValue:c}=o,{mutateAsync:n,isPending:u}=q(i.id),[a,l]=f.useState({}),P=r=>{const d=typeof r=="function"?r(a):r;c("add",Object.keys(d).filter(D=>d[D]),{shouldDirty:!0,shouldTouch:!0}),l(d)};f.useEffect(()=>{c("add",Object.keys(a).filter(r=>a[r]),{shouldDirty:!0,shouldTouch:!0})},[a,c]);const{searchParams:b,raw:v}=B({prefix:h,pageSize:p}),{products:T,count:g,isLoading:w,isError:R,error:k}=O({fields:"*variants,*sales_channels",...b},{placeholderData:H}),x=te(),A=M(["collections"]),{table:E}=L({data:T??[],columns:x,count:g,pageSize:p,prefix:h,getRowId:r=>r.id,enableRowSelection:!0,rowSelection:{state:a,updater:P},enablePagination:!0,meta:{collectionId:i.id}}),I=o.handleSubmit(async r=>{await n({add:r.add},{onSuccess:()=>{j.success(s("collections.products.add.successToast",{count:r.add.length})),t()},onError:d=>{j.error(d.message)}})});if(R)throw k;return e.jsx(m.Form,{form:o,children:e.jsxs("form",{onSubmit:I,className:"flex h-full flex-col overflow-hidden",children:[e.jsx(m.Header,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[o.formState.errors.add&&e.jsx(U,{variant:"error",children:o.formState.errors.add.message}),e.jsx(m.Close,{asChild:!0,children:e.jsx(y,{size:"small",variant:"secondary",children:s("actions.cancel")})}),e.jsx(y,{size:"small",type:"submit",isLoading:u,children:s("actions.save")})]})}),e.jsx(m.Body,{className:"size-full overflow-hidden",children:e.jsx(N,{table:E,columns:x,pageSize:p,count:g,queryObject:v,filters:A,orderBy:["title","created_at","updated_at"],prefix:h,isLoading:w,layout:"fill",pagination:!0,search:!0})})]})})},ee=K(),te=()=>{const{t:i}=C(),s=z();return f.useMemo(()=>[ee.display({id:"select",header:({table:t})=>e.jsx(S,{checked:t.getIsSomePageRowsSelected()?"indeterminate":t.getIsAllPageRowsSelected(),onCheckedChange:o=>t.toggleAllPageRowsSelected(!!o)}),cell:({row:t,table:o})=>{const{collectionId:c}=o.options.meta,n=t.original.collection_id===c,u=t.getIsSelected()||n,a=e.jsx(S,{checked:u,disabled:n,onCheckedChange:l=>t.toggleSelected(!!l),onClick:l=>{l.stopPropagation()}});return n?e.jsx(_,{content:i("salesChannels.productAlreadyAdded"),side:"right",children:a}):a}}),...s],[i,s])},qe=()=>{const{id:i}=F(),{collection:s,isLoading:t,isError:o,error:c}=V(i);if(o)throw c;return e.jsx(m,{children:!t&&s&&e.jsx(Y,{collection:s})})};export{qe as Component};
