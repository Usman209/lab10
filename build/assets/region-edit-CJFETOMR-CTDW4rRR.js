import{f as R}from"./chunk-IR5DHEKS-aVJcUHa1.js";import{C as F}from"./chunk-UY4EBCIZ-BkMu1ycI.js";import{c as I}from"./chunk-MWVM4TYO-bKUcYSnf.js";import{c as T}from"./chunk-TAOSOO55-C3xZaLGt.js";import{u as L,w as N,m as H,o as M,j as e,H as k,t as y,I as z,T as b}from"./index-DQ7iaOIo.js";import{a as l,u as U}from"./chunk-RLLZZQKN-CuYY48Je.js";import{u as B,F as r}from"./chunk-C7RYT3S3-DvWl1ixb.js";import{c as V,d as A}from"./chunk-QHCOJC4V-B0UJ2So3.js";import{o as D,s as _,a as q,b as C}from"./index-yuYasa5Y.js";import{S as u}from"./select-CYzOnLAx.js";import{S as E}from"./switch-CHhgpYt_.js";import{B as P}from"./label-DsyTUQgE.js";import"./x-mark-mini-DjxzaqmQ.js";import"./triangles-mini-BMU6OfpM.js";import"./plus-mini-DfhjBeEB.js";import"./prompt-BKfKBHyN.js";import"./index-CIxKSFC7.js";D({name:_().min(1),currency_code:_(),payment_providers:q(_()),automatic_taxes:C(),is_tax_inclusive:C()});var G=({region:a,currencies:j,paymentProviders:d,pricePreferences:m})=>{var p;const{t:i}=L(),{handleSuccess:h}=U(),t=m==null?void 0:m.find(s=>s.attribute==="region_id"&&s.value===a.id),n=B({defaultValues:{name:a.name,currency_code:a.currency_code.toUpperCase(),payment_providers:((p=a.payment_providers)==null?void 0:p.map(s=>s.id))||[],automatic_taxes:a.automatic_taxes,is_tax_inclusive:(t==null?void 0:t.is_tax_inclusive)||!1}}),{mutateAsync:f,isPending:g}=A(a.id),v=n.handleSubmit(async s=>{await f({name:s.name,currency_code:s.currency_code.toLowerCase(),payment_providers:s.payment_providers,is_tax_inclusive:s.is_tax_inclusive},{onError:o=>{y.error(i("general.error"),{description:o.message,dismissLabel:i("actions.close")})},onSuccess:()=>{y.success(i("regions.toast.edit")),h()},onError:o=>{y.error(o.message)}})});return e.jsx(l.Form,{form:n,children:e.jsxs("form",{onSubmit:v,className:"flex flex-1 flex-col",children:[e.jsx(l.Body,{children:e.jsxs("div",{className:"flex flex-col gap-y-8",children:[e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx(r.Field,{control:n.control,name:"name",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{children:i("fields.name")}),e.jsx(r.Control,{children:e.jsx(z,{...s})}),e.jsx(r.ErrorMessage,{})]})}),e.jsx(r.Field,{control:n.control,name:"currency_code",render:({field:{onChange:s,ref:o,...c}})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{children:i("fields.currency")}),e.jsx(r.Control,{children:e.jsxs(u,{onValueChange:s,...c,children:[e.jsx(u.Trigger,{ref:o,children:e.jsx(u.Value,{})}),e.jsx(u.Content,{children:j.map(x=>e.jsx(u.Item,{value:x.code,children:x.code.toUpperCase()},x.code))})]})}),e.jsx(r.ErrorMessage,{})]})})]}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx(r.Field,{control:n.control,name:"automatic_taxes",render:({field:{value:s,onChange:o,...c}})=>e.jsx(r.Item,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(r.Label,{children:i("fields.automaticTaxes")}),e.jsx(r.Control,{children:e.jsx(E,{...c,checked:s,onCheckedChange:o})})]}),e.jsx(r.Hint,{children:i("regions.automaticTaxesHint")}),e.jsx(r.ErrorMessage,{})]})})}),e.jsx(r.Field,{control:n.control,name:"is_tax_inclusive",render:({field:{value:s,onChange:o,...c}})=>e.jsx(r.Item,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(r.Label,{children:i("fields.taxInclusivePricing")}),e.jsx(r.Control,{children:e.jsx(E,{...c,checked:s,onCheckedChange:o})})]}),e.jsx(r.Hint,{children:i("regions.taxInclusiveHint")}),e.jsx(r.ErrorMessage,{})]})})})]}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsxs("div",{children:[e.jsx(b,{size:"small",leading:"compact",weight:"plus",children:"Providers"}),e.jsx(b,{size:"small",className:"text-ui-fg-subtle",children:i("regions.providersHint")})]}),e.jsx(r.Field,{control:n.control,name:"payment_providers",render:({field:s})=>e.jsxs(r.Item,{children:[e.jsx(r.Label,{children:i("fields.paymentProviders")}),e.jsx(r.Control,{children:e.jsx(F,{options:d.map(o=>({label:R(o.id),value:o.id})),...s})}),e.jsx(r.ErrorMessage,{})]})})]})]})}),e.jsx(l.Footer,{children:e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx(l.Close,{asChild:!0,children:e.jsx(P,{size:"small",variant:"secondary",children:i("actions.cancel")})}),e.jsx(P,{size:"small",type:"submit",isLoading:g,children:i("actions.save")})]})})]})})},ce=()=>{const{t:a}=L(),{id:j}=N(),{region:d,isPending:m,isError:i,error:h}=V(j,{fields:"*payment_providers"}),{store:t,isPending:n,isError:f,error:g}=H(),{price_preferences:v=[],isPending:p,isError:s,error:o}=M({attribute:"region_id",value:j},{enabled:!!d}),c=m||n||p,x=((t==null?void 0:t.supported_currencies)??[]).map(w=>I[w.currency_code.toUpperCase()]),{payment_providers:S=[]}=T({limit:999});if(i)throw h;if(f)throw g;if(s)throw o;return e.jsxs(l,{children:[e.jsx(l.Header,{children:e.jsx(k,{children:a("regions.editRegion")})}),!c&&d&&e.jsx(G,{region:d,currencies:x,paymentProviders:S,pricePreferences:v})]})};export{ce as Component};
