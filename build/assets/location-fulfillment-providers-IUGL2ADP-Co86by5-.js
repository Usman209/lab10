import{f as A}from"./chunk-IR5DHEKS-aVJcUHa1.js";import{u as B}from"./chunk-W7625H47-D80nHBZo.js";import{w as H,j as t,u as _,r as d,t as S,k as N}from"./index-DQ7iaOIo.js";import{T as O,a as I}from"./chunk-IQRVIEMV-CAyGAynz.js";import{u as Q,D as V}from"./chunk-MOFW5DA3-BBRzwwAr.js";import"./lodash-BbEdBw2P.js";import{u as $}from"./chunk-C76H5USB-BzcnRuay.js";import"./chunk-7LAPOKHJ-CJKFdgcT.js";import"./chunk-M566SHKI-CpCecA-q.js";import{u as G,a as U,h as Z}from"./chunk-3UMDCRM2-NSGJIubw.js";import{R as m,u as J}from"./chunk-RLLZZQKN-CuYY48Je.js";import{u as K}from"./chunk-C7RYT3S3-DvWl1ixb.js";import{o as W,a as X,s as Y}from"./index-yuYasa5Y.js";import{t as ee}from"./zod-DqtdDTUb.js";import{B as j}from"./label-DsyTUQgE.js";import{C as y}from"./checkbox-BXdKf1Kl.js";import{c as k}from"./index-DW7vLJga.js";import"./chunk-P3UUX2T6-OlAXa1VC.js";import"./chunk-5FUV23JF-BunLQmqw.js";import"./chunk-RKBIB2RM-cgj6pqOB.js";import"./chunk-WX2SMNCD-CYp4yo3d.js";import"./plus-mini-DfhjBeEB.js";import"./command-bar-B4tNt0in.js";import"./index-T2cn0UOM.js";import"./chunk-QAF7PVQE-D70u5tsT.js";import"./format-CJ2FegFx.js";import"./_baseIsEqual-DdDy9tKi.js";import"./date-picker-BsdoIRhX.js";import"./clsx-B-dksMZM.js";import"./popover-C1ro1ubo.js";import"./x-mark-mini-DjxzaqmQ.js";import"./triangle-left-mini-o3U9ykef.js";import"./prompt-BKfKBHyN.js";import"./index-CIxKSFC7.js";var te=k(),re=()=>{const{t:r}=_();return d.useMemo(()=>[te.accessor("id",{header:()=>t.jsx(O,{text:"Provider"}),cell:({getValue:e})=>t.jsx(I,{text:A(e())})})],[r])},oe=({prefix:r,pageSize:e=20})=>{const o=$(["offset","q","stock_location_id"],r),{offset:i,q:n,stock_location_id:c}=o;return{searchParams:{limit:e,offset:i?Number(i):0,stock_location_id:c,q:n},raw:o}},se=W({fulfillment_providers:X(Y()).optional()}),p=50,ie=({location:r})=>{var v,x;const{t:e}=_(),{handleSuccess:o}=J(),i=K({defaultValues:{fulfillment_providers:((v=r.fulfillment_providers)==null?void 0:v.map(s=>s.id))??[]},resolver:ee(se)}),{setValue:n}=i,c=((x=r.fulfillment_providers)==null?void 0:x.reduce((s,a)=>(s[a.id]=!0,s),{}))??{},[u,C]=d.useState(c);d.useEffect(()=>{const s=Object.keys(u);n("fulfillment_providers",s,{shouldDirty:!0,shouldTouch:!0})},[u,n]);const{searchParams:b,raw:w}=oe({pageSize:p}),{fulfillment_providers:F,count:f,isLoading:T,isError:E,error:R}=U({...b},{placeholderData:N}),D=B(),h=le(),{table:L}=Q({data:F??[],columns:h,count:f,enablePagination:!0,enableRowSelection:!0,rowSelection:{state:u,updater:C},getRowId:s=>s.id,pageSize:p}),{mutateAsync:z,isPending:M}=Z(r.id),q=i.handleSubmit(async s=>{var P;const a=(P=r.fulfillment_providers)==null?void 0:P.map(l=>l.id),g=s.fulfillment_providers??[];await z({add:g.filter(l=>!(a!=null&&a.includes(l))),remove:a==null?void 0:a.filter(l=>!g.includes(l))},{onSuccess:()=>{S.success(e("stockLocations.fulfillmentProviders.successToast")),o(`/settings/locations/${r.id}`)},onError:l=>{S.error(l.message)}})});if(E)throw R;return t.jsx(m.Form,{form:i,children:t.jsxs("div",{className:"flex h-full flex-col overflow-hidden",children:[t.jsx(m.Body,{children:t.jsx(V,{table:L,columns:h,pageSize:p,isLoading:T,count:f,filters:D,search:!0,pagination:!0,orderBy:["id","created_at","updated_at"],queryObject:w,layout:"fill"})}),t.jsx(m.Footer,{children:t.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[t.jsx(m.Close,{asChild:!0,children:t.jsx(j,{size:"small",variant:"secondary",children:e("actions.cancel")})}),t.jsx(j,{size:"small",isLoading:M,onClick:q,children:e("actions.save")})]})})]})})},ae=k(),le=()=>{const r=re();return d.useMemo(()=>[ae.display({id:"select",header:({table:e})=>t.jsx(y,{checked:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),onCheckedChange:o=>e.toggleAllPageRowsSelected(!!o)}),cell:({row:e})=>t.jsx(y,{checked:e.getIsSelected(),onCheckedChange:o=>e.toggleSelected(!!o),onClick:o=>{o.stopPropagation()}})}),...r],[r])},Ie=()=>{const{location_id:r}=H(),{stock_location:e,isPending:o,isError:i,error:n}=G(r,{fields:"id,*fulfillment_providers"}),c=!o&&!!e;if(i)throw n;return t.jsx(m,{children:c&&t.jsx(ie,{location:e})})};export{Ie as Component};
