import{r as i,bx as x,a0 as D,by as v,k as g}from"./index-DQ7iaOIo.js";var q=()=>{const[n,r]=i.useState(""),[s,t]=i.useState(""),a=i.useCallback(x(c=>t(c),300),[]);return i.useEffect(()=>(a(n),()=>a.cancel()),[n,a]),{searchValue:n,onSearchValueChange:r,query:s||void 0}},E=({queryKey:n,queryFn:r,getOptions:s,defaultValue:t,defaultValueKey:a,pageSize:c=10})=>{const{searchValue:y,onSearchValueChange:f,query:d}=q(),l=a||"id",{data:m}=D({queryKey:n,queryFn:async()=>r({[l]:t,limit:Array.isArray(t)?t.length:1}),enabled:!!t}),{data:u,...b}=v({queryKey:[...n,d],queryFn:async({pageParam:e=0})=>await r({q:d,limit:c,offset:e}),initialPageParam:0,getNextPageParam:e=>e.count>e.offset+e.limit?e.offset+e.limit:void 0,placeholderData:g}),o=(u==null?void 0:u.pages.flatMap(e=>s(e)))??[],h=m?s(m):[],p=!b.isPending&&!o.length&&!y;return t&&h.length&&!o.find(e=>e.value===t)&&o.unshift(h[0]),{options:o,searchValue:y,onSearchValueChange:f,disabled:p,...b}};export{q as a,E as u};
