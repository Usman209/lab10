import{f as h}from"./chunk-R6CEB3GW-1KtZJKxo.js";import{g}from"./chunk-MWVM4TYO-bKUcYSnf.js";import{u as p,w as b,j as e,H as v,t as f}from"./index-DQ7iaOIo.js";import{a as C,b as R}from"./chunk-TAOSOO55-C3xZaLGt.js";import{a as n,u as S}from"./chunk-RLLZZQKN-CuYY48Je.js";import{u as F,F as m}from"./chunk-C7RYT3S3-DvWl1ixb.js";import{t as E}from"./zod-DqtdDTUb.js";import{o as N,n as P}from"./index-yuYasa5Y.js";import{C as w}from"./currency-input-YdrMuETU.js";import{B as x}from"./label-DsyTUQgE.js";import"./prompt-BKfKBHyN.js";import"./index.esm-C23H4hs_.js";var B=N({amount:P()}),H=({payment:s})=>{const{t:a}=p(),{handleSuccess:u}=S(),o=s.amount,r=F({defaultValues:{amount:o},resolver:E(B)}),{mutateAsync:l,isPending:y}=R(s.id),j=r.handleSubmit(async c=>{await l({amount:c.amount},{onSuccess:()=>{f.success(a("orders.payment.refundPaymentSuccess",{amount:h(c.amount,s.currency_code)})),u()},onError:i=>{f.error(i.message)}})});return e.jsx(n.Form,{form:r,children:e.jsxs("form",{onSubmit:j,className:"flex flex-1 flex-col",children:[e.jsx(n.Body,{children:e.jsx("div",{className:"flex flex-col gap-y-4",children:e.jsx(m.Field,{control:r.control,name:"amount",rules:{required:!0,min:0,max:o},render:({field:{onChange:c,...i}})=>e.jsxs(m.Item,{children:[e.jsx(m.Label,{children:a("fields.amount")}),e.jsx(m.Control,{children:e.jsx(w,{...i,min:0,onChange:d=>{const t=d.target.value===""?null:Number(d.target.value);c(t),t&&!isNaN(t)&&(t<0||t>o?r.setError("amount",{type:"manual",message:a("orders.payment.createRefundWrongQuantity",{number:o})}):r.clearErrors("amount"))},code:s.currency_code,symbol:g(s.currency_code),value:i.value})}),e.jsx(m.ErrorMessage,{})]})})})}),e.jsx(n.Footer,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[e.jsx(n.Close,{asChild:!0,children:e.jsx(x,{variant:"secondary",size:"small",children:a("actions.cancel")})}),e.jsx(x,{isLoading:y,type:"submit",variant:"primary",size:"small",disabled:!!Object.keys(r.formState.errors||{}).length,children:a("actions.save")})]})})]})})},V=()=>{const{t:s}=p(),a=b(),{payment:u,isLoading:o,isError:r,error:l}=C(a.paymentId);if(r)throw l;return e.jsxs(n,{children:[e.jsx(n.Header,{children:e.jsx(v,{children:s("orders.payment.createRefund")})}),!o&&u&&e.jsx(H,{payment:u})]})};export{V as Component};
