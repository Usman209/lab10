import{u as re,a as se,b as te}from"./chunk-WL3E5WGF-DlT5cRnz.js";import{S as ie}from"./chunk-FGHVNTU2-B17BbdmQ.js";import"./chunk-3IW4HYUP-DTbTbYs9.js";import{r as x,q as M,h as oe,m as ne,j as s,cl as ae,co as ce,cp as le,k as ue,o as de,cq as H,u as _,C as W,H as K,A as k,T as p,B as pe,t as f}from"./index-DQ7iaOIo.js";import{S as me}from"./chunk-ADOCJB6L-DwJI6LYz.js";import{u as ge,D as xe}from"./chunk-MOFW5DA3-BBRzwwAr.js";import"./lodash-BbEdBw2P.js";import"./chunk-7LAPOKHJ-CJKFdgcT.js";import"./chunk-M566SHKI-CpCecA-q.js";import{c as fe}from"./chunk-QHCOJC4V-B0UJ2So3.js";import{P as he}from"./plus-CQspOzlS.js";import{P as ve}from"./pencil-square-C2dQ88SM.js";import{X as ye}from"./x-circle-DtLjBqH9.js";import{T as _e}from"./trash-AHlgA58B.js";import{u as Y}from"./use-prompt-DSUtE_64.js";import{C as h}from"./command-bar-B4tNt0in.js";import{C as B}from"./checkbox-BXdKf1Kl.js";import{c as je}from"./index-DW7vLJga.js";import"./chunk-IQRVIEMV-CAyGAynz.js";import"./chunk-P3UUX2T6-OlAXa1VC.js";import"./chunk-C76H5USB-BzcnRuay.js";import"./arrow-up-right-on-box-CErxVq_8.js";import"./Trans-LG4CmYWt.js";import"./x-mark-mini-DjxzaqmQ.js";import"./triangle-down-mini-CMQwg4p-.js";import"./square-two-stack-0Hf-pV3m.js";import"./chunk-5FUV23JF-BunLQmqw.js";import"./chunk-RKBIB2RM-cgj6pqOB.js";import"./label-DsyTUQgE.js";import"./chunk-WX2SMNCD-CYp4yo3d.js";import"./plus-mini-DfhjBeEB.js";import"./chunk-QAF7PVQE-D70u5tsT.js";import"./format-CJ2FegFx.js";import"./_baseIsEqual-DdDy9tKi.js";import"./date-picker-BsdoIRhX.js";import"./clsx-B-dksMZM.js";import"./popover-C1ro1ubo.js";import"./index-T2cn0UOM.js";import"./triangle-left-mini-o3U9ykef.js";import"./prompt-BKfKBHyN.js";import"./index-CIxKSFC7.js";var Ce=Object.defineProperty,y=Object.getOwnPropertySymbols,G=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable,Q=(r,e,t)=>e in r?Ce(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Se=(r,e)=>{for(var t in e||(e={}))G.call(e,t)&&Q(r,t,e[t]);if(y)for(var t of y(e))J.call(e,t)&&Q(r,t,e[t]);return r},we=(r,e)=>{var t={};for(var i in r)G.call(r,i)&&e.indexOf(i)<0&&(t[i]=r[i]);if(r!=null&&y)for(var i of y(r))e.indexOf(i)<0&&J.call(r,i)&&(t[i]=r[i]);return t};const U=x.forwardRef((r,e)=>{var t=r,{color:i="currentColor"}=t,a=we(t,["color"]);return x.createElement("svg",Se({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:e},a),x.createElement("path",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7.5 13.945a6.444 6.444 0 1 0 0-12.89 6.444 6.444 0 0 0 0 12.89"}),x.createElement("path",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"m4.611 7.722 2 2.223 3.778-4.89"}))});U.displayName="CheckCircle";const Pe={widgets:[]},be={widgets:[]};var ke=()=>({queryKey:ce.details(),queryFn:async()=>le()}),yr=async()=>{const r=ke();return M.getQueryData(r.queryKey)??await M.fetchQuery(r)},P=10,Te=({store:r})=>{var I,O,N,R,z,D,q,A;const[e,t]=x.useState({}),{searchParams:i,raw:a}=re({pageSize:P}),{currencies:c,count:o,isPending:m,isError:j,error:C}=se({code:(I=r.supported_currencies)==null?void 0:I.map(n=>n.currency_code),...i},{placeholderData:ue,enabled:!!((O=r.supported_currencies)!=null&&O.length)}),{price_preferences:g,isPending:v,isError:d,error:l}=de({attribute:"currency_code",value:(N=r.supported_currencies)==null?void 0:N.map(n=>n.currency_code)},{enabled:!!((R=r.supported_currencies)!=null&&R.length)}),T=Ie(),E=x.useMemo(()=>new Map(g==null?void 0:g.map(n=>[n.value,n])),[g]),V=c==null?void 0:c.map(n=>{var S;return{...n,is_tax_inclusive:(S=E.get(n.code))==null?void 0:S.is_tax_inclusive}}),{table:X}=ge({data:V??[],columns:T,count:o,getRowId:n=>n.code,rowSelection:{state:e,updater:t},enablePagination:!0,enableRowSelection:!0,pageSize:P,meta:{storeId:r.id,supportedCurrencies:r.supported_currencies,defaultCurrencyCode:(D=(z=r.supported_currencies)==null?void 0:z.find(n=>n.is_default))==null?void 0:D.currency_code,preferencesMap:E}}),{mutateAsync:F}=H(r.id),{t:u}=_(),Z=Y(),$=async()=>{var L;const n=Object.keys(e);await Z({title:u("general.areYouSure"),description:u("store.removeCurrencyWarning",{count:n.length}),confirmText:u("actions.remove"),cancelText:u("actions.cancel")})&&await F({supported_currencies:((L=r.supported_currencies)==null?void 0:L.filter(w=>!n.includes(w.currency_code)))??[]},{onSuccess:()=>{t({}),f.success(u("store.toast.currenciesRemoved"))},onError:w=>{f.error(w.message)}})};if(j)throw C;if(d)throw l;const ee=m||v;return s.jsxs(W,{className:"divide-y p-0",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[s.jsx(K,{level:"h2",children:u("store.currencies")}),s.jsx(k,{groups:[{actions:[{icon:s.jsx(he,{}),label:u("actions.add"),to:"currencies"}]}]})]}),s.jsx(xe,{orderBy:["code","name"],search:!0,pagination:!0,table:X,pageSize:P,columns:T,count:(q=r.supported_currencies)!=null&&q.length?o:0,isLoading:(A=r.supported_currencies)!=null&&A.length?ee:!1,queryObject:a}),s.jsx(h,{open:!!Object.keys(e).length,children:s.jsxs(h.Bar,{children:[s.jsx(h.Value,{children:u("general.countSelected",{count:Object.keys(e).length})}),s.jsx(h.Seperator,{}),s.jsx(h.Command,{action:$,shortcut:"r",label:u("actions.remove")})]})})]})},Ee=({storeId:r,currency:e,supportedCurrencies:t,defaultCurrencyCode:i,preferencesMap:a})=>{var g,v;const{mutateAsync:c}=H(r),{t:o}=_(),m=Y(),j=async()=>{await m({title:o("general.areYouSure"),description:o("store.removeCurrencyWarning",{count:1}),verificationInstruction:o("general.typeToConfirm"),verificationText:e.name,confirmText:o("actions.remove"),cancelText:o("actions.cancel")})&&await c({supported_currencies:t.filter(l=>l.currency_code!==e.code)},{onSuccess:()=>{f.success(o("store.toast.currenciesRemoved"))},onError:l=>{f.error(l.message)}})},C=async()=>{await c({supported_currencies:t.map(d=>{const l=a.get(d.currency_code);return{...d,is_tax_inclusive:d.currency_code===e.code?!(l!=null&&l.is_tax_inclusive):void 0}})},{onSuccess:()=>{f.success(o("store.toast.updatedTaxInclusivitySuccessfully"))},onError:d=>{f.error(d.message)}})};return s.jsx(k,{groups:[{actions:[{icon:(g=a.get(e.code))!=null&&g.is_tax_inclusive?s.jsx(ye,{}):s.jsx(U,{}),label:(v=a.get(e.code))!=null&&v.is_tax_inclusive?o("store.disableTaxInclusivePricing"):o("store.enableTaxInclusivePricing"),onClick:C}]},{actions:[{icon:s.jsx(_e,{}),label:o("actions.remove"),onClick:j,disabled:e.code===i}]}]})},b=je(),Ie=()=>{const r=te(),{t:e}=_();return x.useMemo(()=>[b.display({id:"select",header:({table:t})=>s.jsx(B,{checked:t.getIsSomePageRowsSelected()?"indeterminate":t.getIsAllPageRowsSelected(),onCheckedChange:i=>t.toggleAllPageRowsSelected(!!i)}),cell:({row:t})=>s.jsx(B,{checked:t.getIsSelected(),onCheckedChange:i=>t.toggleSelected(!!i),onClick:i=>{i.stopPropagation()}})}),...r,b.accessor("is_tax_inclusive",{header:e("fields.taxInclusivePricing"),cell:({getValue:t})=>{const i=t();return s.jsx(me,{color:i?"green":"grey",children:e(i?"fields.true":"fields.false")})}}),b.display({id:"actions",cell:({row:t,table:i})=>{const{supportedCurrencies:a,storeId:c,defaultCurrencyCode:o,preferencesMap:m}=i.options.meta;return s.jsx(Ee,{storeId:c,currency:t.original,supportedCurrencies:a,defaultCurrencyCode:o,preferencesMap:m})}})],[r,e])},Oe=({store:r})=>{var a,c,o;const{t:e}=_(),{region:t}=fe(r.default_region_id,void 0,{enabled:!!r.default_region_id}),i=(a=r.supported_currencies)==null?void 0:a.find(m=>m.is_default);return s.jsxs(W,{className:"divide-y p-0",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[s.jsxs("div",{children:[s.jsx(K,{children:e("store.domain")}),s.jsx(p,{className:"text-ui-fg-subtle",size:"small",children:e("store.manageYourStoresDetails")})]}),s.jsx(k,{groups:[{actions:[{icon:s.jsx(ve,{}),label:e("actions.edit"),to:"edit"}]}]})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 px-6 py-4",children:[s.jsx(p,{size:"small",leading:"compact",weight:"plus",children:e("fields.name")}),s.jsx(p,{size:"small",leading:"compact",children:r.name})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 px-6 py-4",children:[s.jsx(p,{size:"small",leading:"compact",weight:"plus",children:e("store.defaultCurrency")}),i?s.jsxs("div",{className:"flex items-center gap-x-2",children:[s.jsx(pe,{size:"2xsmall",children:(c=i.currency_code)==null?void 0:c.toUpperCase()}),s.jsx(p,{size:"small",leading:"compact",children:(o=i.currency)==null?void 0:o.name})]}):s.jsx(p,{size:"small",leading:"compact",children:"-"})]}),s.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 px-6 py-4",children:[s.jsx(p,{size:"small",leading:"compact",weight:"plus",children:e("store.defaultRegion")}),s.jsx("div",{className:"flex items-center gap-x-2",children:s.jsx(p,{size:"small",leading:"compact",children:(t==null?void 0:t.name)||"-"})})]})]})},_r=()=>{const r=oe(),{store:e,isPending:t,isError:i,error:a}=ne(void 0,{initialData:r});if(t||!e)return s.jsx(ae,{sections:2,showJSON:!0,showMetadata:!0});if(i)throw a;return s.jsxs(ie,{widgets:{before:be,after:Pe},data:e,hasOutlet:!0,showMetadata:!0,showJSON:!0,children:[s.jsx(Oe,{store:e}),s.jsx(Te,{store:e})]})};export{_r as Component,yr as loader};
