import{i as y,a as se}from"./chunk-R2O6QX4D-CX21ziz_.js";import{I as S}from"./chunk-EQTBJSBZ-C6oQs6qn.js";import{L as q}from"./chunk-I3VB6NM2-DUTkn0yW.js";import{L as M}from"./chunk-6WKBBTKM-BQVKseFE.js";import{f as V}from"./chunk-IR5DHEKS-aVJcUHa1.js";import{a as te}from"./chunk-OIAPXGI2-CCQfJ697.js";import{J as D}from"./chunk-3IW4HYUP-DTbTbYs9.js";import{r,q as z,h as ne,w as ie,j as e,O as ae,s as oe,cv as re,C as L,H as N,T as h,u as x,A as g,b as le,bW as ce,n as de,t as m,D as A,B as pe,P as me}from"./index-DQ7iaOIo.js";import{N as T}from"./chunk-WX2SMNCD-CYp4yo3d.js";import{a as fe}from"./chunk-AYIUW4A5-32QjTsWY.js";import{u as ue,a as xe}from"./chunk-4HI66HSD-Qtu4Hyf5.js";import{a as he}from"./chunk-RJJ3HJT5-0qvBrSK4.js";import{u as ge,s as ve,e as je,c as _e,a as ye}from"./chunk-3UMDCRM2-NSGJIubw.js";import{P as Z}from"./plus-CQspOzlS.js";import{T as O}from"./trash-AHlgA58B.js";import{P as _}from"./pencil-square-C2dQ88SM.js";import{T as we}from"./triangle-down-mini-CMQwg4p-.js";import{C as ke}from"./channels-D-_ZQ20f.js";import{u as C}from"./use-prompt-DSUtE_64.js";import{S as be}from"./status-badge-CrS-Pq0N.js";import"./arrow-up-right-on-box-CErxVq_8.js";import"./Trans-LG4CmYWt.js";import"./x-mark-mini-DjxzaqmQ.js";import"./square-two-stack-0Hf-pV3m.js";import"./plus-mini-DfhjBeEB.js";import"./label-DsyTUQgE.js";import"./chunk-4N7PLYUW-DRfoew5M.js";import"./chunk-DMYZ6SLX-CvGU_oYL.js";import"./prompt-BKfKBHyN.js";var Le=Object.defineProperty,w=Object.getOwnPropertySymbols,I=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable,B=(s,n,t)=>n in s?Le(s,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[n]=t,Ne=(s,n)=>{for(var t in n||(n={}))I.call(n,t)&&B(s,t,n[t]);if(w)for(var t of w(n))Q.call(n,t)&&B(s,t,n[t]);return s},Oe=(s,n)=>{var t={};for(var i in s)I.call(s,i)&&n.indexOf(i)<0&&(t[i]=s[i]);if(s!=null&&w)for(var i of w(s))n.indexOf(i)<0&&Q.call(s,i)&&(t[i]=s[i]);return t};const Y=r.forwardRef((s,n)=>{var t=s,{color:i="currentColor"}=t,o=Oe(t,["color"]);return r.createElement("svg",Ne({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:n},o),r.createElement("g",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#a)"},r.createElement("path",{d:"M12.611 5.056v6.222c0 .982-.795 1.778-1.778 1.778H4.167a1.777 1.777 0 0 1-1.778-1.778V5.056M13.056 1.944H1.944a.89.89 0 0 0-.888.89v1.333c0 .49.398.888.888.888h11.112a.89.89 0 0 0 .888-.888V2.833a.89.89 0 0 0-.889-.889M5.722 7.722h3.556"})),r.createElement("defs",null,r.createElement("clipPath",{id:"a"},r.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});Y.displayName="ArchiveBox";var Ce=Object.defineProperty,k=Object.getOwnPropertySymbols,K=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable,F=(s,n,t)=>n in s?Ce(s,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[n]=t,$e=(s,n)=>{for(var t in n||(n={}))K.call(n,t)&&F(s,t,n[t]);if(k)for(var t of k(n))G.call(n,t)&&F(s,t,n[t]);return s},Pe=(s,n)=>{var t={};for(var i in s)K.call(s,i)&&n.indexOf(i)<0&&(t[i]=s[i]);if(s!=null&&k)for(var i of k(s))n.indexOf(i)<0&&G.call(s,i)&&(t[i]=s[i]);return t};const J=r.forwardRef((s,n)=>{var t=s,{color:i="currentColor"}=t,o=Pe(t,["color"]);return r.createElement("svg",$e({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:n},o),r.createElement("g",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#a)"},r.createElement("path",{d:"M10.6918 3.42715L6.96541 4.49011C6.50807 4.62056 6.24309 5.09706 6.37354 5.5544L7.31839 8.86672C7.44885 9.32405 7.92535 9.58904 8.38269 9.45858L12.109 8.39563C12.5664 8.26517 12.8314 7.78867 12.7009 7.33133L11.7561 4.01901C11.6256 3.56168 11.1491 3.29669 10.6918 3.42715Z",stroke:"#52525B",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M8.82837 3.95886L9.30112 5.61478",stroke:"#52525B",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M7.37573 12.2083L14.6736 10.127",stroke:"#52525B",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M5.43299 10.8572L3.26988 3.24407C3.16482 2.87379 2.8264 2.61804 2.44149 2.61804H1.54163",stroke:"#52525B",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M5.84728 13.8125C6.67954 13.8125 7.35422 13.1378 7.35422 12.3055C7.35422 11.4733 6.67954 10.7986 5.84728 10.7986C5.01501 10.7986 4.34033 11.4733 4.34033 12.3055C4.34033 13.1378 5.01501 13.8125 5.84728 13.8125Z",stroke:"#52525B",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})),r.createElement("defs",null,r.createElement("clipPath",{id:"a"},r.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});J.displayName="HandTruck";var Ee=Object.defineProperty,b=Object.getOwnPropertySymbols,U=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable,H=(s,n,t)=>n in s?Ee(s,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[n]=t,Se=(s,n)=>{for(var t in n||(n={}))U.call(n,t)&&H(s,t,n[t]);if(b)for(var t of b(n))X.call(n,t)&&H(s,t,n[t]);return s},Te=(s,n)=>{var t={};for(var i in s)U.call(s,i)&&n.indexOf(i)<0&&(t[i]=s[i]);if(s!=null&&b)for(var i of b(s))n.indexOf(i)<0&&X.call(s,i)&&(t[i]=s[i]);return t};const E=r.forwardRef((s,n)=>{var t=s,{color:i="currentColor"}=t,o=Te(t,["color"]);return r.createElement("svg",Se({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:n},o),r.createElement("g",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#a)"},r.createElement("path",{d:"M5.056 1.982v9.333M9.944 3.685v9.333M1.752 2.679 4.802 2a.9.9 0 0 1 .497.032l4.402 1.601c.159.058.331.07.497.032l2.665-.592a.888.888 0 0 1 1.081.868v7.513c0 .417-.29.778-.696.867l-3.05.679a.9.9 0 0 1-.497-.032l-4.402-1.601a.9.9 0 0 0-.497-.032l-2.665.592a.89.89 0 0 1-1.081-.868V3.546c0-.417.29-.778.696-.867"})),r.createElement("defs",null,r.createElement("clipPath",{id:"a"},r.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});E.displayName="Map";const Me={widgets:[]},De={widgets:[]},ze={widgets:[]},Ae={widgets:[]};var ee="name,*sales_channels,*address,fulfillment_sets.type,fulfillment_sets.name,*fulfillment_sets.service_zones.geo_zones,*fulfillment_sets.service_zones,*fulfillment_sets.service_zones.shipping_options,*fulfillment_sets.service_zones.shipping_options.rules,*fulfillment_sets.service_zones.shipping_options.shipping_profile,*fulfillment_providers",Ze=s=>({queryKey:ve.detail(s),queryFn:async()=>await oe.admin.stockLocation.retrieve(s,{fields:ee}).catch(n=>{throw n.status===401?re("/login"):n})}),ws=async({params:s})=>{const n=s.location_id,t=Ze(n);return z.getQueryData(t.queryKey)??await z.fetchQuery(t)},Be=({location:s})=>{var n,t;return e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"p-0",children:e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsxs("div",{children:[e.jsx(N,{children:s.name}),e.jsx(h,{className:"text-ui-fg-subtle txt-small",children:te({address:s.address}).join(", ")})]}),e.jsx(Re,{location:s})]})}),e.jsx(W,{locationId:s.id,locationName:s.name,type:"pickup",fulfillmentSet:(n=s.fulfillment_sets)==null?void 0:n.find(i=>i.type==="pickup")}),e.jsx(W,{locationId:s.id,locationName:s.name,type:"shipping",fulfillmentSet:(t=s.fulfillment_sets)==null?void 0:t.find(i=>i.type==="shipping")})]})};function R({option:s,fulfillmentSetId:n,locationId:t}){const i=C(),{t:o}=x(),l=se(s),{mutateAsync:a}=he(s.id),c=async()=>{await i({title:o("general.areYouSure"),description:o("stockLocations.shippingOptions.delete.confirmation",{name:s.name}),verificationInstruction:o("general.typeToConfirm"),verificationText:s.name,confirmText:o("actions.delete"),cancelText:o("actions.cancel")})&&await a(void 0,{onSuccess:()=>{m.success(o("stockLocations.shippingOptions.delete.successToast",{name:s.name}))},onError:j=>{m.error(j.message)}})};return e.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[e.jsx("div",{className:"flex-1",children:e.jsxs(h,{size:"small",weight:"plus",children:[s.name," - ",s.shipping_profile.name," (",V(s.provider_id),")"]})}),e.jsx(pe,{className:"mr-4",color:l?"grey":"purple",size:"2xsmall",rounded:"full",children:o(l?"general.store":"general.admin")}),e.jsx(g,{groups:[{actions:[{icon:e.jsx(_,{}),label:o("stockLocations.shippingOptions.edit.action"),to:`/settings/locations/${t}/fulfillment-set/${n}/service-zone/${s.service_zone_id}/shipping-option/${s.id}/edit`},{label:o("stockLocations.shippingOptions.pricing.action"),icon:e.jsx(me,{}),to:`/settings/locations/${t}/fulfillment-set/${n}/service-zone/${s.service_zone_id}/shipping-option/${s.id}/pricing`}]},{actions:[{label:o("actions.delete"),icon:e.jsx(O,{}),onClick:c}]}]})]})}function Fe({zone:s,locationId:n,fulfillmentSetId:t}){const{t:i}=x(),o=s.shipping_options.filter(a=>!y(a)),l=s.shipping_options.filter(a=>y(a));return e.jsxs("div",{children:[e.jsx(A,{variant:"dashed"}),e.jsxs("div",{className:"flex flex-col gap-y-4 px-6 py-4",children:[e.jsxs("div",{className:"item-center flex justify-between",children:[e.jsx("span",{className:"text-ui-fg-subtle txt-small self-center font-medium",children:i("stockLocations.shippingOptions.create.shipping.label")}),e.jsx(M,{to:`/settings/locations/${n}/fulfillment-set/${t}/service-zone/${s.id}/shipping-option/create`,children:i("stockLocations.shippingOptions.create.action")})]}),!!o.length&&e.jsx("div",{className:"shadow-elevation-card-rest bg-ui-bg-subtle grid divide-y rounded-md",children:o.map(a=>e.jsx(R,{option:a,locationId:n,fulfillmentSetId:t},a.id))})]}),e.jsx(A,{variant:"dashed"}),e.jsxs("div",{className:"flex flex-col gap-y-4 px-6 py-4",children:[e.jsxs("div",{className:"item-center flex justify-between",children:[e.jsx("span",{className:"text-ui-fg-subtle txt-small self-center font-medium",children:i("stockLocations.shippingOptions.create.returns.label")}),e.jsx(M,{to:`/settings/locations/${n}/fulfillment-set/${t}/service-zone/${s.id}/shipping-option/create?is_return`,children:i("stockLocations.shippingOptions.create.action")})]}),!!l.length&&e.jsx("div",{className:"shadow-elevation-card-rest bg-ui-bg-subtle grid divide-y rounded-md",children:l.map(a=>e.jsx(R,{option:a,locationId:n,fulfillmentSetId:t},a.id))})]})]})}function He({zone:s,locationId:n,fulfillmentSetId:t}){const{t:i}=x(),o=C(),[l,a]=r.useState(!0),{mutateAsync:c}=xe(t,s.id),v=async()=>{await o({title:i("general.areYouSure"),description:i("stockLocations.serviceZones.delete.confirmation",{name:s.name}),confirmText:i("actions.delete"),cancelText:i("actions.cancel")})&&await c(void 0,{onError:f=>{m.error(f.message)},onSuccess:()=>{m.success(i("stockLocations.serviceZones.delete.successToast",{name:s.name}))}})},j=r.useMemo(()=>{const p=s.geo_zones.filter(d=>d.type==="country"),f=p.map(({country_code:d})=>ce.find(u=>u.iso_2===d)).filter(d=>!!d);return p.length!==f.length&&console.warn("Some countries are missing in the static countries list",p.filter(d=>!f.find(u=>u.iso_2===d.country_code)).map(d=>d.country_code)),f.sort((d,u)=>d.name.localeCompare(u.name))},[s.geo_zones]),[$,P]=r.useMemo(()=>{const p=s.shipping_options,f=p.filter(u=>!y(u)).length,d=p.filter(y).length;return[f,d]},[s.shipping_options]);return e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-row items-center justify-between gap-x-4 px-6 py-4",children:[e.jsx(S,{children:e.jsx(E,{})}),e.jsxs("div",{className:"grow-1 flex flex-1 flex-col",children:[e.jsx(h,{size:"small",leading:"compact",weight:"plus",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(q,{variant:"base",list:j.map(p=>p.display_name),inline:!0,n:1}),e.jsx("span",{children:"·"}),e.jsx(h,{className:"text-ui-fg-subtle txt-small",children:i("stockLocations.shippingOptions.fields.count.shipping",{count:$})}),e.jsx("span",{children:"·"}),e.jsx(h,{className:"text-ui-fg-subtle txt-small",children:i("stockLocations.shippingOptions.fields.count.returns",{count:P})})]})]}),e.jsxs("div",{className:"flex grow-0 items-center gap-4",children:[e.jsx(de,{size:"small",onClick:()=>a(p=>!p),variant:"transparent",children:e.jsx(we,{style:{transform:`rotate(${l?180:0}deg)`,transition:".2s transform ease-in-out"}})}),e.jsx(g,{groups:[{actions:[{label:i("actions.edit"),icon:e.jsx(_,{}),to:`/settings/locations/${n}/fulfillment-set/${t}/service-zone/${s.id}/edit`},{label:i("stockLocations.serviceZones.manageAreas.action"),icon:e.jsx(E,{}),to:`/settings/locations/${n}/fulfillment-set/${t}/service-zone/${s.id}/areas`}]},{actions:[{label:i("actions.delete"),icon:e.jsx(O,{}),onClick:v}]}]})]})]}),l&&e.jsx(Fe,{fulfillmentSetId:t,locationId:n,zone:s})]})}function W(s){const{t:n}=x(),t=C(),{fulfillmentSet:i,locationName:o,locationId:l,type:a}=s,c=!!i,v=!!(i!=null&&i.service_zones.length),{mutateAsync:j}=je(l),{mutateAsync:$}=ue(i==null?void 0:i.id),P=async()=>{await j({name:`${o} ${a==="pickup"?"pick up":a}`,type:a},{onSuccess:()=>{m.success(n(`stockLocations.fulfillmentSets.enable.${a}`))},onError:d=>{m.error(d.message)}})},p=async()=>{await t({title:n("general.areYouSure"),description:n("stockLocations.fulfillmentSets.disable.confirmation",{name:i==null?void 0:i.name}),confirmText:n("actions.disable"),cancelText:n("actions.cancel")})&&await $(void 0,{onSuccess:()=>{m.success(n(`stockLocations.fulfillmentSets.disable.${a}`))},onError:u=>{m.error(u.message)}})},f=i?[{actions:[{icon:e.jsx(Z,{}),label:n("stockLocations.serviceZones.create.action"),to:`/settings/locations/${l}/fulfillment-set/${i.id}/service-zones/create`}]},{actions:[{icon:e.jsx(O,{}),label:n("actions.disable"),onClick:p}]}]:[{actions:[{icon:e.jsx(Z,{}),label:n("actions.enable"),onClick:P}]}];return e.jsx(L,{className:"p-0",children:e.jsxs("div",{className:"flex flex-col divide-y",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(N,{level:"h2",children:n(`stockLocations.fulfillmentSets.${a}.header`)}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(be,{color:c?"green":"grey",children:n(c?"statuses.enabled":"statuses.disabled")}),e.jsx(g,{groups:f})]})]}),c&&!v&&e.jsx("div",{className:"flex items-center justify-center py-8 pt-6",children:e.jsx(T,{message:n("stockLocations.serviceZones.fields.noRecords"),className:"h-fit",action:{to:`/settings/locations/${l}/fulfillment-set/${i.id}/service-zones/create`,label:n("stockLocations.serviceZones.create.action")}})}),v&&e.jsx("div",{className:"flex flex-col divide-y",children:i==null?void 0:i.service_zones.map(d=>e.jsx(He,{zone:d,locationId:l,fulfillmentSetId:i.id},d.id))})]})})}var Re=({location:s})=>{const n=le(),{t}=x(),{mutateAsync:i}=_e(s.id),o=C(),l=async()=>{await o({title:t("general.areYouSure"),description:t("stockLocations.delete.confirmation",{name:s.name}),verificationText:s.name,verificationInstruction:t("general.typeToConfirm"),confirmText:t("actions.delete"),cancelText:t("actions.cancel")})&&await i(void 0,{onSuccess:()=>{m.success(t("stockLocations.create.successToast",{name:s.name})),n("/settings/locations",{replace:!0})},onError:c=>{m.error(c.message)}})};return e.jsx(g,{groups:[{actions:[{icon:e.jsx(_,{}),label:t("actions.edit"),to:"edit"},{icon:e.jsx(Y,{}),label:t("stockLocations.edit.viewInventory"),to:`/inventory?location_id=${s.id}`}]},{actions:[{icon:e.jsx(O,{}),label:t("actions.delete"),onClick:l}]}]})};function We({location:s}){var o,l,a;const{t:n}=x(),{count:t}=fe({limit:1,fields:"id"}),i=!!((o=s.sales_channels)!=null&&o.length);return e.jsxs(L,{className:"flex flex-col px-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(N,{level:"h2",children:n("stockLocations.salesChannels.header")}),e.jsx(g,{groups:[{actions:[{label:n("actions.edit"),to:"sales-channels",icon:e.jsx(_,{})}]}]})]}),i?e.jsxs("div",{className:"flex flex-col gap-y-4 pt-4",children:[e.jsxs("div",{className:"grid grid-cols-[28px_1fr] items-center gap-x-3",children:[e.jsx(S,{children:e.jsx(ke,{className:"text-ui-fg-subtle"})}),e.jsx(q,{n:3,className:"text-ui-fg-base",inline:!0,list:((l=s.sales_channels)==null?void 0:l.map(c=>c.name))??[]})]}),e.jsx(h,{className:"text-ui-fg-subtle",size:"small",leading:"compact",children:n("stockLocations.salesChannels.connectedTo",{count:(a=s.sales_channels)==null?void 0:a.length,total:t})})]}):e.jsx(T,{className:"h-fit pb-2 pt-6",action:{label:n("stockLocations.salesChannels.action"),to:"sales-channels"},message:n("stockLocations.salesChannels.noChannels")})]})}var qe=We;function Ve({location:s}){const{t:n}=x(),{fulfillment_providers:t}=ye({stock_location_id:s.id,fields:"id"});return e.jsxs(L,{className:"flex flex-col px-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(N,{level:"h2",children:n("stockLocations.fulfillmentProviders.header")}),e.jsx(g,{groups:[{actions:[{label:n("actions.edit"),to:"fulfillment-providers",icon:e.jsx(_,{})}]}]})]}),t!=null&&t.length?e.jsx("div",{className:"flex flex-col gap-y-4 pt-4",children:e.jsx("div",{className:"grid grid-cols-[28px_1fr] items-center gap-x-3 gap-y-3",children:t==null?void 0:t.map(i=>e.jsxs(e.Fragment,{children:[e.jsx(S,{children:e.jsx(J,{className:"text-ui-fg-subtle"})}),e.jsx("div",{className:"txt-compact-small",children:V(i.id)})]}))})}):e.jsx(T,{className:"h-fit pb-2 pt-6 text-center",action:{label:n("stockLocations.fulfillmentProviders.action"),to:"fulfillment-providers"},message:n("stockLocations.fulfillmentProviders.noProviders")})]})}var Ie=Ve,ks=()=>{const s=ne(),{location_id:n}=ie(),{stock_location:t,isPending:i,isError:o,error:l}=ge(n,{fields:ee},{initialData:s});if(i||!t)return e.jsx("div",{children:"Loading..."});if(o)throw l;return e.jsxs("div",{className:"flex flex-col gap-y-3",children:[De.widgets.map((a,c)=>e.jsx("div",{children:e.jsx(a.Component,{data:t})},c)),e.jsxs("div",{className:"flex flex-col gap-y-3 xl:flex-row xl:items-start xl:gap-x-4",children:[e.jsxs("div",{className:"flex w-full flex-col gap-y-3",children:[e.jsx(Be,{location:t}),Me.widgets.map((a,c)=>e.jsx("div",{children:e.jsx(a.Component,{data:t})},c)),e.jsx("div",{className:"hidden xl:block",children:e.jsx(D,{data:t})})]}),e.jsxs("div",{className:"flex w-full max-w-[100%] flex-col gap-y-3 xl:mt-0 xl:max-w-[400px]",children:[Ae.widgets.map((a,c)=>e.jsx("div",{children:e.jsx(a.Component,{data:t})},c)),e.jsx(qe,{location:t}),e.jsx(Ie,{location:t}),ze.widgets.map((a,c)=>e.jsx("div",{children:e.jsx(a.Component,{data:t})},c)),e.jsx("div",{className:"xl:hidden",children:e.jsx(D,{data:t})})]}),e.jsx(ae,{})]})]})};export{ks as Component,ws as loader};
