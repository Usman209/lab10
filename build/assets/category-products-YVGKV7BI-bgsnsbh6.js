import{u as I}from"./chunk-QBDU475K--UbpR47S.js";import{w as H,j as e,u as P,r as S,t as h,y as A}from"./index-DQ7iaOIo.js";import{u as B,a as D}from"./chunk-55F244YM-B_ivUNU-.js";import{u as M,D as N}from"./chunk-MOFW5DA3-BBRzwwAr.js";import"./lodash-BbEdBw2P.js";import"./chunk-7LAPOKHJ-CJKFdgcT.js";import"./chunk-M566SHKI-CpCecA-q.js";import{u as L}from"./chunk-4N7PLYUW-DRfoew5M.js";import{R as u,u as O}from"./chunk-RLLZZQKN-CuYY48Je.js";import{u as V,H as q}from"./chunk-C7RYT3S3-DvWl1ixb.js";import{b as G,d as Q}from"./chunk-2FB644HY-BHty38NP.js";import{t as U}from"./zod-DqtdDTUb.js";import{z as l}from"./index-yuYasa5Y.js";import{B as x}from"./label-DsyTUQgE.js";import{C as y}from"./checkbox-BXdKf1Kl.js";import{c as X}from"./index-DW7vLJga.js";import"./chunk-6XHB4MRO-D_LOUyOE.js";import"./chunk-PHMALPVO-BXYfPvrg.js";import"./chunk-ADOCJB6L-DwJI6LYz.js";import"./chunk-P3UUX2T6-OlAXa1VC.js";import"./chunk-C76H5USB-BzcnRuay.js";import"./chunk-NGTKJO6Q-CBxZNPj4.js";import"./chunk-OPYB3EPU-Gu9ostxc.js";import"./chunk-AYIUW4A5-32QjTsWY.js";import"./chunk-5FUV23JF-BunLQmqw.js";import"./chunk-RKBIB2RM-cgj6pqOB.js";import"./chunk-WX2SMNCD-CYp4yo3d.js";import"./plus-mini-DfhjBeEB.js";import"./command-bar-B4tNt0in.js";import"./index-T2cn0UOM.js";import"./chunk-QAF7PVQE-D70u5tsT.js";import"./format-CJ2FegFx.js";import"./_baseIsEqual-DdDy9tKi.js";import"./date-picker-BsdoIRhX.js";import"./clsx-B-dksMZM.js";import"./popover-C1ro1ubo.js";import"./x-mark-mini-DjxzaqmQ.js";import"./triangle-left-mini-o3U9ykef.js";import"./chunk-DMYZ6SLX-CvGU_oYL.js";import"./prompt-BKfKBHyN.js";import"./index-CIxKSFC7.js";var Z=l.object({product_ids:l.array(l.string())}),m=50,p="p",$=({categoryId:c,products:o=[]})=>{const{t}=P(),{handleSuccess:s}=O(),[d,n]=S.useState(o.reduce((r,a)=>(r[a.id]=!0,r),{})),i=V({defaultValues:{product_ids:[]},resolver:U(Z)}),j=r=>{const a=typeof r=="function"?r(d):r;i.setValue("product_ids",Object.keys(a),{shouldDirty:!0,shouldTouch:!0}),n(a)},{searchParams:C,raw:b}=B({pageSize:m,prefix:p}),{products:v,count:g,isPending:_,isError:E,error:R}=L({...C,category_id:[c]}),f=K(),T=D(["categories"]),{table:w}=M({data:v,columns:f,getRowId:r=>r.id,count:g,pageSize:m,prefix:p,enableRowSelection:r=>!o.some(a=>a.id===r.original.id),enablePagination:!0,rowSelection:{state:d,updater:j}}),{mutateAsync:k,isPending:z}=Q(c),F=i.handleSubmit(async r=>{await k({add:r.product_ids},{onSuccess:()=>{h.success(t("categories.products.add.disabledTooltip",{count:r.product_ids.length})),s()},onError:a=>{h.error(a.message)}})});if(E)throw R;return e.jsx(u.Form,{form:i,children:e.jsxs("form",{onSubmit:F,className:"flex h-full flex-col overflow-hidden",children:[e.jsx(u.Header,{children:e.jsxs("div",{className:"flex items-center justify-end gap-x-2",children:[i.formState.errors.product_ids&&e.jsx(q,{variant:"error",children:i.formState.errors.product_ids.message}),e.jsx(u.Close,{asChild:!0,children:e.jsx(x,{size:"small",variant:"secondary",children:t("actions.cancel")})}),e.jsx(x,{size:"small",type:"submit",isLoading:z,children:t("actions.save")})]})}),e.jsx(u.Body,{className:"size-full overflow-hidden",children:e.jsx(N,{table:w,columns:f,pageSize:m,count:g,queryObject:b,filters:T,orderBy:["title","created_at","updated_at"],prefix:p,isLoading:_,layout:"fill",pagination:!0,search:!0})})]})})},J=X(),K=()=>{const{t:c}=P(),o=I();return S.useMemo(()=>[J.display({id:"select",header:({table:t})=>e.jsx(y,{checked:t.getIsSomePageRowsSelected()?"indeterminate":t.getIsAllPageRowsSelected(),onCheckedChange:s=>t.toggleAllPageRowsSelected(!!s)}),cell:({row:t})=>{const s=!t.getCanSelect(),d=t.getIsSelected()||s,n=e.jsx(y,{checked:d,disabled:s,onCheckedChange:i=>t.toggleSelected(!!i),onClick:i=>{i.stopPropagation()}});return s?e.jsx(A,{content:c("categories.products.add.disabledTooltip"),side:"right",children:n}):n}}),...o],[c,o])},Ne=()=>{const{id:c}=H(),{product_category:o,isPending:t,isError:s,error:d}=G(c,{fields:"*products"}),n=!t&&!!o;if(s)throw d;return e.jsx(u,{children:n&&e.jsx($,{categoryId:o.id,products:o.products})})};export{Ne as Component};
